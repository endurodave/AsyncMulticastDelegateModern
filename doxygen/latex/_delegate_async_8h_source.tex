\doxysection{Delegate\+Async.\+h}
\hypertarget{_delegate_async_8h_source}{}\label{_delegate_async_8h_source}\index{C:/Projects/AsyncMulticastDelegateModern/src/Delegate/DelegateAsync.h@{C:/Projects/AsyncMulticastDelegateModern/src/Delegate/DelegateAsync.h}}
\mbox{\hyperlink{_delegate_async_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ \_DELEGATE\_ASYNC\_H}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ \_DELEGATE\_ASYNC\_H}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{comment}{//\ DelegateAsync.h}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ @see\ https://github.com/endurodave/AsyncMulticastDelegateModern}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ David\ Lafreniere,\ Aug\ 2020.}}
\DoxyCodeLine{00007\ \textcolor{comment}{//}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ Delegate\ "{}Async"{}\ series\ of\ classes\ used\ to\ invoke\ a\ function\ asynchronously.\ The\ classes\ }}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ are\ not\ thread\ safe.\ Invoking\ a\ function\ asynchronously\ requires\ sending\ a\ clone\ of\ the\ object\ }}
\DoxyCodeLine{00010\ \textcolor{comment}{//\ to\ the\ destination\ thread\ message\ queue.\ The\ destination\ thread\ calls\ DelegateInvoke()\ to\ }}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ invoke\ the\ target\ function.}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ }}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ Code\ within\ <common\_code>\ and\ </common\_code>\ is\ updated\ using\ sync\_src.py.\ Manually\ update\ }}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ the\ code\ within\ the\ DelegateFreeAsync\ common\_code\ tags,\ then\ run\ the\ script\ to\ }}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ propagate\ to\ the\ remaining\ delegate\ classes\ to\ simplify\ code\ maintenance.}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ }}
\DoxyCodeLine{00017\ \textcolor{comment}{//\ python\ src\_dup.py\ DelegateAsync.h}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_delegate_8h}{Delegate.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_delegate_thread_8h}{DelegateThread.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_delegate_invoker_8h}{DelegateInvoker.h}}"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ <tuple>}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_delegate_lib}{DelegateLib}}\ \{}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00028\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}...Args>}
\DoxyCodeLine{00029\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_msg}{DelegateAsyncMsg}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_msg}{DelegateMsg}}}
\DoxyCodeLine{00030\ \{}
\DoxyCodeLine{00031\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00035\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_msg_a708106c763651c6a4e2daee4f227a06b}{DelegateAsyncMsg}}(std::shared\_ptr<IDelegateInvoker>\ invoker,\ Args...\ args)\ :\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_msg}{DelegateMsg}}(invoker),}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ m\_args(\mbox{\hyperlink{namespace_delegate_lib_aaec1863ccd49b0020b485d9755ab4705}{make\_tuple\_heap}}(m\_heapMem,\ m\_start,\ args...))}
\DoxyCodeLine{00037\ \ \ \ \ \{}
\DoxyCodeLine{00038\ \ \ \ \ \}}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_msg_aa5d364db00da8cc35316667d3d9aec21}{\string~DelegateAsyncMsg}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00044\ \ \ \ \ std::tuple<Args...>\&\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_msg_a1aee414f10fd730ec393aab7ead86cbd}{GetArgs}}()\ \{\ \textcolor{keywordflow}{return}\ m\_args;\ \}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00048\ \ \ \ \ \mbox{\hyperlink{_delegate_opt_8h_a9e6c72a4d9879e662d02c096cf16ff3c}{xlist<std::shared\_ptr<heap\_arg\_deleter\_base>}}>\ m\_heapMem;}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00051\ \ \ \ \ std::tuple<>\ m\_start;}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00054\ \ \ \ \ std::tuple<Args...>\ m\_args;}
\DoxyCodeLine{00055\ \};}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ R>}
\DoxyCodeLine{00058\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_delegate_lib_1_1_delegate_free_async}{DelegateFreeAsync}};\ \textcolor{comment}{//\ Not\ defined}}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \textcolor{comment}{//\ DelegateFreeAsync\ class\ asynchronously\ invokes\ a\ free\ target\ function.}}
\DoxyCodeLine{00061\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }RetType,\ \textcolor{keyword}{class}...\ Args>}
\DoxyCodeLine{00062\ \textcolor{keyword}{class\ }\mbox{\hyperlink{struct_delegate_lib_1_1_delegate_free_async}{DelegateFreeAsync}}<RetType(Args...)>\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_free}{DelegateFree}}<RetType(Args...)>,\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_delegate_lib_1_1_i_delegate_invoker}{IDelegateInvoker}}\ \{}
\DoxyCodeLine{00063\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keyword}{typedef}\ RetType(*FreeFunc)(Args...);}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\ =\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_free_async}{DelegateFreeAsync}}<RetType(Args...)>;}
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_3_01_ret_type_07_args_8_8_8_08_4}{BaseType}}\ =\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_free}{DelegateFree}}<RetType(Args...)>;}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4_aa527333a1d851bf51a8805496983691a}{DelegateFreeAsync}}(FreeFunc\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread)\ :}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_3_01_ret_type_07_args_8_8_8_08_4}{BaseType}}(func),\ m\_thread(thread)\ \{\ }
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ Bind(func,\ thread);\ }
\DoxyCodeLine{00071\ \ \ \ \ \}}
\DoxyCodeLine{00072\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4_af28c5262b9be9417d3b40804b6d473d3}{DelegateFreeAsync}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ rhs)\ :}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_3_01_ret_type_07_args_8_8_8_08_4}{BaseType}}(rhs),\ m\_thread(rhs.m\_thread)\ \{}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ Assign(rhs);}
\DoxyCodeLine{00075\ \ \ \ \ \}}
\DoxyCodeLine{00076\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4_a7e948b875da7fc4bafe5e6b74b47ecf4}{DelegateFreeAsync}}()\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{comment}{//\ Bind\ a\ free\ function\ to\ the\ delegate.}}
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4_aba44cf5c963b9b7667cc1ea70023e343}{Bind}}(FreeFunc\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread)\ \{}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ m\_thread\ =\ thread;}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ BaseType::Bind(func);}
\DoxyCodeLine{00082\ \ \ \ \ \}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{comment}{//\ <common\_code>}}
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4_a98d999c16d8eff2e9967d0a4c25b9d41}{Assign}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ rhs)\ \{}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ m\_thread\ =\ rhs.m\_thread;}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ BaseType::Assign(rhs);}
\DoxyCodeLine{00088\ \ \ \ \ \}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}*\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4_afe0877cb9e0d97f5b5ca408de1562b89}{Clone}}()\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{00092\ \ \ \ \ \}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4_a681a97f01b1b14b4149cd82e3269ddb4}{operator=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ rhs)\ \{}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\&rhs\ !=\ \textcolor{keyword}{this})\ \{}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ BaseType::operator=(rhs);}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \ \ \ \ Assign(rhs);}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00100\ \ \ \ \ \}}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4_a9ef5e4510f2f3378d0dd0c3ff714e3bf}{operator==}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_base}{DelegateBase}}\&\ rhs)\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ derivedRhs\ =\ \textcolor{keyword}{dynamic\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}*\textcolor{keyword}{>}(\&rhs);}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ derivedRhs\ \&\&}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \ \ \ \ \&m\_thread\ ==\ \&derivedRhs-\/>m\_thread\ \&\&}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \ \ \ \ BaseType::operator==(rhs);}
\DoxyCodeLine{00107\ \ \ \ \ \}}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{comment}{//\ Invoke\ delegate\ function\ asynchronously.\ Do\ not\ wait\ for\ return\ value,\ if\ any.}}
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{comment}{//\ Called\ by\ the\ source\ thread.\ Dispatches\ the\ delegate\ data\ into\ the\ destination\ }}
\DoxyCodeLine{00111\ \ \ \ \ \textcolor{comment}{//\ thread\ message\ queue.\ DelegateInvoke()\ must\ be\ called\ by\ the\ destination\ thread\ }}
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{comment}{//\ to\ invoke\ the\ target\ function.}}
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keyword}{virtual}\ RetType\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4_a8d6f10d5f2c1b9215b59946a77edf6f6}{operator()}}(Args...\ args)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>GetSync())}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ BaseType::operator()(args...);}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ a\ clone\ instance\ of\ this\ delegate\ }}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ delegate\ =\ std::shared\_ptr<ClassType>(Clone());}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ the\ delegate\ message}}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ msg\ =\ std::make\_shared<\mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_msg}{DelegateAsyncMsg}}<Args...>>(delegate,\ args...);}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Dispatch\ message\ onto\ the\ callback\ destination\ thread.\ DelegateInvoke()}}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ will\ be\ called\ by\ the\ destintation\ thread.\ }}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ GetThread().DispatchDelegate(msg);}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Do\ not\ wait\ for\ destination\ thread\ return\ value\ from\ async\ function\ call}}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ RetType();}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Check\ if\ any\ argument\ is\ a\ shared\_ptr\ with\ wrong\ usage}}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ std::shared\_ptr\ reference\ arguments\ are\ not\ allowed\ with\ asynchronous\ delegates\ as\ the\ behavior\ is\ }}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ undefined.\ In\ other\ words:}}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ void\ MyFunc(std::shared\_ptr<T>\ data)\ \ \ \ \ //\ Ok!}}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ void\ MyFunc(std::shared\_ptr<T>\&\ data)\ \ \ \ //\ Error\ if\ DelegateAsync\ or\ DelegateSpAsync\ target!}}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_assert}(!(std::disjunction\_v<is\_shared\_ptr<Args>...>\ \&\&}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (std::disjunction\_v<std::is\_lvalue\_reference<Args>,\ std::is\_pointer<Args>>\ ||\ ...)),}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}std::shared\_ptr\ reference\ argument\ not\ allowed"{}});}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00140\ \ \ \ \ \}}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{comment}{//\ Invoke\ delegate\ function\ asynchronously.\ Do\ not\ wait\ for\ return\ value,\ if\ any.}}
\DoxyCodeLine{00143\ \ \ \ \ \textcolor{comment}{//\ Called\ by\ the\ source\ thread.}}
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4_a2f0ac18839223393d6c8a76beb971478}{AsyncInvoke}}(Args...\ args)\ \{}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ operator()(args...);\ \ \ }
\DoxyCodeLine{00146\ \ \ \ \ \}}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{comment}{//\ Invoke\ the\ delegate\ function\ on\ the\ destination\ thread.\ Each\ source\ thread\ call}}
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{comment}{//\ to\ operator()\ generate\ a\ call\ to\ DelegateInvoke()\ on\ the\ destination\ thread.\ }}
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{comment}{//\ Unlike\ DelegateAsyncWait,\ a\ lock\ is\ not\ required\ between\ source\ and\ destination\ }}
\DoxyCodeLine{00151\ \ \ \ \ \textcolor{comment}{//\ delegateMsg\ access\ because\ the\ source\ thread\ is\ not\ waiting\ for\ the\ function\ call\ }}
\DoxyCodeLine{00152\ \ \ \ \ \textcolor{comment}{//\ to\ complete.}}
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4_a18d39e4e8e3e6906fd9c07ada1ac5bc6}{DelegateInvoke}}(std::shared\_ptr<DelegateMsg>\ msg)\ \{}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Typecast\ the\ base\ pointer\ to\ back\ correct\ derived\ to\ instance}}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ delegateMsg\ =\ std::dynamic\_pointer\_cast<\mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_msg}{DelegateAsyncMsg}}<Args...>>(msg);}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (delegateMsg\ ==\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Invalid\ DelegateMsgHeapArgs\ cast"{}});}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Invoke\ the\ delegate\ function\ asynchronously}}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ SetSync(\textcolor{keyword}{true});}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ std::apply(\&BaseType::operator(),\ }
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ std::tuple\_cat(std::make\_tuple(\textcolor{keyword}{this}),\ delegateMsg-\/>GetArgs()));}
\DoxyCodeLine{00163\ \ \ \ \ \}}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ destination\ thread\ that\ the\ target\ function\ is\ invoked\ on}}
\DoxyCodeLine{00166\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4_a4f86a71601b797dc9356f0f27e61327f}{GetThread}}()\ \{\ \textcolor{keywordflow}{return}\ m\_thread;\ \}}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00168\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00169\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4_a73fa99c10f6b68b771bb8e83adffc444}{GetSync}}()\ \{\ \textcolor{keywordflow}{return}\ m\_sync;\ \}}
\DoxyCodeLine{00170\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4_ae1af8ea348c4121033e815ffb91ffc7f}{SetSync}}(\textcolor{keywordtype}{bool}\ sync)\ \{\ m\_sync\ =\ sync;\ \}}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00173\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ m\_thread;\ \ \ \textcolor{comment}{//\ The\ target\ thread\ to\ invoke\ the\ delegate\ function.}}
\DoxyCodeLine{00174\ \ \ \ \ \textcolor{keywordtype}{bool}\ m\_sync\ =\ \textcolor{keyword}{false};\ \ \ \ \ \ \ \ \textcolor{comment}{//\ Flag\ to\ control\ synchronous\ vs\ asynchronous\ behavior.}}
\DoxyCodeLine{00175\ \ \ \ \ \textcolor{comment}{//\ </common\_code>}}
\DoxyCodeLine{00176\ \};}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00178\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ C,\ \textcolor{keyword}{class}\ R>}
\DoxyCodeLine{00179\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_async}{DelegateMemberAsync}};\ \textcolor{comment}{//\ Not\ defined}}
\DoxyCodeLine{00180\ }
\DoxyCodeLine{00181\ \textcolor{comment}{//\ DelegateMemberAsync\ class\ asynchronously\ invokes\ a\ class\ member\ target\ function.}}
\DoxyCodeLine{00182\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }TClass,\ \textcolor{keyword}{class\ }RetType,\ \textcolor{keyword}{class}...\ Args>}
\DoxyCodeLine{00183\ \textcolor{keyword}{class\ }\mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_async}{DelegateMemberAsync}}<TClass,\ RetType(Args...)>\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member}{DelegateMember}}<TClass,\ RetType(Args...)>,\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_delegate_lib_1_1_i_delegate_invoker}{IDelegateInvoker}}\ \{}
\DoxyCodeLine{00184\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00185\ \ \ \ \ \textcolor{keyword}{typedef}\ TClass*\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_acfabf1d64175cf35c3ddc562d9921ac2}{ObjectPtr}};}
\DoxyCodeLine{00186\ \ \ \ \ \textcolor{keyword}{typedef}\ RetType\ (TClass::*MemberFunc)(Args...);}
\DoxyCodeLine{00187\ \ \ \ \ \textcolor{keyword}{typedef}\ RetType\ (TClass::*ConstMemberFunc)(Args...)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00188\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\ =\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_async}{DelegateMemberAsync}}<TClass,\ RetType(Args...)>;}
\DoxyCodeLine{00189\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{BaseType}}\ =\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member}{DelegateMember}}<TClass,\ RetType(Args...)>;}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a8fe4844542d5e2881cb85e7c5f8cc1c9}{DelegateMemberAsync}}(\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_acfabf1d64175cf35c3ddc562d9921ac2}{ObjectPtr}}\ \textcolor{keywordtype}{object},\ MemberFunc\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread)\ :\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{BaseType}}(object,\ func),\ m\_thread(thread)}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \{\ Bind(\textcolor{keywordtype}{object},\ func,\ thread);\ \}}
\DoxyCodeLine{00193\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a797d31931f53b5c43c75b712e2c4acc1}{DelegateMemberAsync}}(\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_acfabf1d64175cf35c3ddc562d9921ac2}{ObjectPtr}}\ \textcolor{keywordtype}{object},\ ConstMemberFunc\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread)\ :\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{BaseType}}(object,\ func),\ m\_thread(thread)}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \{\ Bind(\textcolor{keywordtype}{object},\ func,\ thread);\ \}}
\DoxyCodeLine{00195\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a222976657b434d64f0c3a6d5dc4426c4}{DelegateMemberAsync}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ rhs)\ :}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{BaseType}}(rhs),\ m\_thread(rhs.m\_thread)\ \{}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ Assign(rhs);}
\DoxyCodeLine{00198\ \ \ \ \ \}}
\DoxyCodeLine{00199\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a498aee49e9441a11f859ead02545b79c}{DelegateMemberAsync}}()\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00202\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_aaa1df37c6b1b6f9549de0daa981fafcf}{Bind}}(\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_acfabf1d64175cf35c3ddc562d9921ac2}{ObjectPtr}}\ \textcolor{keywordtype}{object},\ MemberFunc\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread)\ \{}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ m\_thread\ =\ thread;}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ BaseType::Bind(\textcolor{keywordtype}{object},\ func);}
\DoxyCodeLine{00205\ \ \ \ \ \}}
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00208\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a00787579ccdcf94fea924f2aa3b05cde}{Bind}}(\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_acfabf1d64175cf35c3ddc562d9921ac2}{ObjectPtr}}\ \textcolor{keywordtype}{object},\ ConstMemberFunc\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread)\ \{}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ m\_thread\ =\ thread;}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ BaseType::Bind(\textcolor{keywordtype}{object},\ func);}
\DoxyCodeLine{00211\ \ \ \ \ \}}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00213\ \ \ \ \ \textcolor{comment}{//\ <common\_code>}}
\DoxyCodeLine{00214\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_abe340362fa1daacc9e1d0b58428506e5}{Assign}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ rhs)\ \{}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ m\_thread\ =\ rhs.m\_thread;}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ BaseType::Assign(rhs);}
\DoxyCodeLine{00217\ \ \ \ \ \}}
\DoxyCodeLine{00218\ }
\DoxyCodeLine{00219\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}*\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_acbd04f7121278e2dae40311c4f303d9b}{Clone}}()\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{00221\ \ \ \ \ \}}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a46343959b0ea03ef02f1ebe3f8182814}{operator=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ rhs)\ \{}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\&rhs\ !=\ \textcolor{keyword}{this})\ \{}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \ \ \ BaseType::operator=(rhs);}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \ \ \ \ Assign(rhs);}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00229\ \ \ \ \ \}}
\DoxyCodeLine{00230\ }
\DoxyCodeLine{00231\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a367221c5c3b36d7aae675cadaa2c27ba}{operator==}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_base}{DelegateBase}}\&\ rhs)\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ derivedRhs\ =\ \textcolor{keyword}{dynamic\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}*\textcolor{keyword}{>}(\&rhs);}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ derivedRhs\ \&\&}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ \&m\_thread\ ==\ \&derivedRhs-\/>m\_thread\ \&\&}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \ \ BaseType::operator==(rhs);}
\DoxyCodeLine{00236\ \ \ \ \ \}}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ \ \ \ \ \textcolor{comment}{//\ Invoke\ delegate\ function\ asynchronously.\ Do\ not\ wait\ for\ return\ value,\ if\ any.}}
\DoxyCodeLine{00239\ \ \ \ \ \textcolor{comment}{//\ Called\ by\ the\ source\ thread.\ Dispatches\ the\ delegate\ data\ into\ the\ destination\ }}
\DoxyCodeLine{00240\ \ \ \ \ \textcolor{comment}{//\ thread\ message\ queue.\ DelegateInvoke()\ must\ be\ called\ by\ the\ destination\ thread\ }}
\DoxyCodeLine{00241\ \ \ \ \ \textcolor{comment}{//\ to\ invoke\ the\ target\ function.}}
\DoxyCodeLine{00242\ \ \ \ \ \textcolor{keyword}{virtual}\ RetType\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_aa73f04631d245b5bf76b6e3025a0b5e5}{operator()}}(Args...\ args)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>GetSync())}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ BaseType::operator()(args...);}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ a\ clone\ instance\ of\ this\ delegate\ }}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ delegate\ =\ std::shared\_ptr<ClassType>(Clone());}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ the\ delegate\ message}}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ msg\ =\ std::make\_shared<\mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_msg}{DelegateAsyncMsg}}<Args...>>(delegate,\ args...);}
\DoxyCodeLine{00252\ }
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Dispatch\ message\ onto\ the\ callback\ destination\ thread.\ DelegateInvoke()}}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ will\ be\ called\ by\ the\ destintation\ thread.\ }}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ GetThread().DispatchDelegate(msg);}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Do\ not\ wait\ for\ destination\ thread\ return\ value\ from\ async\ function\ call}}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ RetType();}
\DoxyCodeLine{00259\ }
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Check\ if\ any\ argument\ is\ a\ shared\_ptr\ with\ wrong\ usage}}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ std::shared\_ptr\ reference\ arguments\ are\ not\ allowed\ with\ asynchronous\ delegates\ as\ the\ behavior\ is\ }}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ undefined.\ In\ other\ words:}}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ void\ MyFunc(std::shared\_ptr<T>\ data)\ \ \ \ \ //\ Ok!}}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ void\ MyFunc(std::shared\_ptr<T>\&\ data)\ \ \ \ //\ Error\ if\ DelegateAsync\ or\ DelegateSpAsync\ target!}}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_assert}(!(std::disjunction\_v<is\_shared\_ptr<Args>...>\ \&\&}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (std::disjunction\_v<std::is\_lvalue\_reference<Args>,\ std::is\_pointer<Args>>\ ||\ ...)),}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}std::shared\_ptr\ reference\ argument\ not\ allowed"{}});}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00269\ \ \ \ \ \}}
\DoxyCodeLine{00270\ }
\DoxyCodeLine{00271\ \ \ \ \ \textcolor{comment}{//\ Invoke\ delegate\ function\ asynchronously.\ Do\ not\ wait\ for\ return\ value,\ if\ any.}}
\DoxyCodeLine{00272\ \ \ \ \ \textcolor{comment}{//\ Called\ by\ the\ source\ thread.}}
\DoxyCodeLine{00273\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a66a4e60715f3379696d120cbfd0d0010}{AsyncInvoke}}(Args...\ args)\ \{}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ operator()(args...);\ \ \ }
\DoxyCodeLine{00275\ \ \ \ \ \}}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \ \ \ \ \textcolor{comment}{//\ Invoke\ the\ delegate\ function\ on\ the\ destination\ thread.\ Each\ source\ thread\ call}}
\DoxyCodeLine{00278\ \ \ \ \ \textcolor{comment}{//\ to\ operator()\ generate\ a\ call\ to\ DelegateInvoke()\ on\ the\ destination\ thread.\ }}
\DoxyCodeLine{00279\ \ \ \ \ \textcolor{comment}{//\ Unlike\ DelegateAsyncWait,\ a\ lock\ is\ not\ required\ between\ source\ and\ destination\ }}
\DoxyCodeLine{00280\ \ \ \ \ \textcolor{comment}{//\ delegateMsg\ access\ because\ the\ source\ thread\ is\ not\ waiting\ for\ the\ function\ call\ }}
\DoxyCodeLine{00281\ \ \ \ \ \textcolor{comment}{//\ to\ complete.}}
\DoxyCodeLine{00282\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a97ee00052f6de71e7910784dce3b0fa4}{DelegateInvoke}}(std::shared\_ptr<DelegateMsg>\ msg)\ \{}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Typecast\ the\ base\ pointer\ to\ back\ correct\ derived\ to\ instance}}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ delegateMsg\ =\ std::dynamic\_pointer\_cast<\mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_msg}{DelegateAsyncMsg}}<Args...>>(msg);}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (delegateMsg\ ==\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Invalid\ DelegateMsgHeapArgs\ cast"{}});}
\DoxyCodeLine{00287\ }
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Invoke\ the\ delegate\ function\ asynchronously}}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ SetSync(\textcolor{keyword}{true});}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ std::apply(\&BaseType::operator(),\ }
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \ \ \ \ std::tuple\_cat(std::make\_tuple(\textcolor{keyword}{this}),\ delegateMsg-\/>GetArgs()));}
\DoxyCodeLine{00292\ \ \ \ \ \}}
\DoxyCodeLine{00293\ }
\DoxyCodeLine{00294\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ destination\ thread\ that\ the\ target\ function\ is\ invoked\ on}}
\DoxyCodeLine{00295\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a6af16d159e7441797be012cfafb7eb82}{GetThread}}()\ \{\ \textcolor{keywordflow}{return}\ m\_thread;\ \}}
\DoxyCodeLine{00296\ }
\DoxyCodeLine{00297\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00298\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_aec8a8636e131eb2746311426dacb7490}{GetSync}}()\ \{\ \textcolor{keywordflow}{return}\ m\_sync;\ \}}
\DoxyCodeLine{00299\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a93e6a8587d6f62f39f9dcf6e0c016d9b}{SetSync}}(\textcolor{keywordtype}{bool}\ sync)\ \{\ m\_sync\ =\ sync;\ \}}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00302\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ m\_thread;\ \ \ \textcolor{comment}{//\ The\ target\ thread\ to\ invoke\ the\ delegate\ function.}}
\DoxyCodeLine{00303\ \ \ \ \ \textcolor{keywordtype}{bool}\ m\_sync\ =\ \textcolor{keyword}{false};\ \ \ \ \ \ \ \ \textcolor{comment}{//\ Flag\ to\ control\ synchronous\ vs\ asynchronous\ behavior.}}
\DoxyCodeLine{00304\ \ \ \ \ \textcolor{comment}{//\ </common\_code>}}
\DoxyCodeLine{00305\ \};}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00307\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ C,\ \textcolor{keyword}{class}\ R>}
\DoxyCodeLine{00308\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_sp_async}{DelegateMemberSpAsync}};\ \textcolor{comment}{//\ Not\ defined}}
\DoxyCodeLine{00309\ }
\DoxyCodeLine{00310\ \textcolor{comment}{//\ DelegateMemberSpAsync\ class\ asynchronously\ invokes\ a\ std::shared\_ptr\ target\ function.}}
\DoxyCodeLine{00311\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }TClass,\ \textcolor{keyword}{class\ }RetType,\ \textcolor{keyword}{class}...\ Args>}
\DoxyCodeLine{00312\ \textcolor{keyword}{class\ }\mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_sp_async}{DelegateMemberSpAsync}}<TClass,\ RetType(Args...)>\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_sp}{DelegateMemberSp}}<TClass,\ RetType(Args...)>,\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_delegate_lib_1_1_i_delegate_invoker}{IDelegateInvoker}}\ \{}
\DoxyCodeLine{00313\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00314\ \ \ \ \ \textcolor{keyword}{typedef}\ std::shared\_ptr<TClass>\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a05f0450821590a09623dc84c0e8ba0a5}{ObjectPtr}};}
\DoxyCodeLine{00315\ \ \ \ \ \textcolor{keyword}{typedef}\ RetType(TClass::*\ MemberFunc)(Args...);}
\DoxyCodeLine{00316\ \ \ \ \ \textcolor{keyword}{typedef}\ RetType(TClass::*\ ConstMemberFunc)(Args...)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00317\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\ =\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_sp_async}{DelegateMemberSpAsync}}<TClass,\ RetType(Args...)>;}
\DoxyCodeLine{00318\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{BaseType}}\ =\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_sp}{DelegateMemberSp}}<TClass,\ RetType(Args...)>;}
\DoxyCodeLine{00319\ }
\DoxyCodeLine{00320\ \ \ \ \ \textcolor{comment}{//\ Contructors\ take\ a\ class\ instance,\ member\ function,\ and\ callback\ thread}}
\DoxyCodeLine{00321\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_ac13850e9003f5cd8cb81077b6011b76a}{DelegateMemberSpAsync}}(\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a05f0450821590a09623dc84c0e8ba0a5}{ObjectPtr}}\ \textcolor{keywordtype}{object},\ MemberFunc\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread)\ :\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{BaseType}}(object,\ func),\ m\_thread(thread)\ \{}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ Bind(\textcolor{keywordtype}{object},\ func,\ thread);}
\DoxyCodeLine{00323\ \ \ \ \ \}}
\DoxyCodeLine{00324\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a0415b2d8187f48557166d43ee5746b8e}{DelegateMemberSpAsync}}(\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a05f0450821590a09623dc84c0e8ba0a5}{ObjectPtr}}\ \textcolor{keywordtype}{object},\ ConstMemberFunc\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread)\ :\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{BaseType}}(object,\ func),\ m\_thread(thread)\ \{}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ Bind(\textcolor{keywordtype}{object},\ func,\ thread);}
\DoxyCodeLine{00326\ \ \ \ \ \}}
\DoxyCodeLine{00327\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a4aae9e2e271efa00a60d6f6c61d454ec}{DelegateMemberSpAsync}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ rhs)\ :}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{BaseType}}(rhs),\ m\_thread(rhs.m\_thread)\ \{}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ Assign(rhs);}
\DoxyCodeLine{00330\ \ \ \ \ \}}
\DoxyCodeLine{00331\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a95abbb7549ad531efec4a5fe629ca925}{DelegateMemberSpAsync}}()\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00332\ }
\DoxyCodeLine{00333\ \ \ \ \ \textcolor{comment}{//\ Bind\ a\ member\ function\ to\ a\ delegate.\ }}
\DoxyCodeLine{00334\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a4a810a41f439b74a0bcbaaf8dd7eb07e}{Bind}}(\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a05f0450821590a09623dc84c0e8ba0a5}{ObjectPtr}}\ \textcolor{keywordtype}{object},\ MemberFunc\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread)\ \{}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ m\_thread\ =\ thread;}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ BaseType::Bind(\textcolor{keywordtype}{object},\ func);}
\DoxyCodeLine{00337\ \ \ \ \ \}}
\DoxyCodeLine{00338\ }
\DoxyCodeLine{00339\ \ \ \ \ \textcolor{comment}{//\ Bind\ a\ const\ member\ function\ to\ a\ delegate.\ }}
\DoxyCodeLine{00340\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a8fa9581587b6d143a9149168eae1855d}{Bind}}(\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a05f0450821590a09623dc84c0e8ba0a5}{ObjectPtr}}\ \textcolor{keywordtype}{object},\ ConstMemberFunc\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread)\ \{}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ m\_thread\ =\ thread;}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ BaseType::Bind(\textcolor{keywordtype}{object},\ func);}
\DoxyCodeLine{00343\ \ \ \ \ \}}
\DoxyCodeLine{00344\ }
\DoxyCodeLine{00345\ \ \ \ \ \textcolor{comment}{//\ <common\_code>}}
\DoxyCodeLine{00346\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a2d0dde29df4be4db2480ccd419f6cbed}{Assign}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ rhs)\ \{}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ m\_thread\ =\ rhs.m\_thread;}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ BaseType::Assign(rhs);}
\DoxyCodeLine{00349\ \ \ \ \ \}}
\DoxyCodeLine{00350\ }
\DoxyCodeLine{00351\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}*\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_af3bd3f99355e53854fc17d086a7a95c9}{Clone}}()\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{00353\ \ \ \ \ \}}
\DoxyCodeLine{00354\ }
\DoxyCodeLine{00355\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_adb92f14347b35af2b3154103b1793196}{operator=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ rhs)\ \{}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\&rhs\ !=\ \textcolor{keyword}{this})\ \{}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ \ \ BaseType::operator=(rhs);}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \ \ \ \ Assign(rhs);}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00361\ \ \ \ \ \}}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a6cef069e1ec3020064447a453c3aa91b}{operator==}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_base}{DelegateBase}}\&\ rhs)\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ derivedRhs\ =\ \textcolor{keyword}{dynamic\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}*\textcolor{keyword}{>}(\&rhs);}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ derivedRhs\ \&\&}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \ \ \ \ \&m\_thread\ ==\ \&derivedRhs-\/>m\_thread\ \&\&}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \ \ \ \ BaseType::operator==(rhs);}
\DoxyCodeLine{00368\ \ \ \ \ \}}
\DoxyCodeLine{00369\ }
\DoxyCodeLine{00370\ \ \ \ \ \textcolor{comment}{//\ Invoke\ delegate\ function\ asynchronously.\ Do\ not\ wait\ for\ return\ value,\ if\ any.}}
\DoxyCodeLine{00371\ \ \ \ \ \textcolor{comment}{//\ Called\ by\ the\ source\ thread.\ Dispatches\ the\ delegate\ data\ into\ the\ destination\ }}
\DoxyCodeLine{00372\ \ \ \ \ \textcolor{comment}{//\ thread\ message\ queue.\ DelegateInvoke()\ must\ be\ called\ by\ the\ destination\ thread\ }}
\DoxyCodeLine{00373\ \ \ \ \ \textcolor{comment}{//\ to\ invoke\ the\ target\ function.}}
\DoxyCodeLine{00374\ \ \ \ \ \textcolor{keyword}{virtual}\ RetType\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a2be69705010b23423760a63822b2f408}{operator()}}(Args...\ args)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>GetSync())}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ BaseType::operator()(args...);}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ a\ clone\ instance\ of\ this\ delegate\ }}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ delegate\ =\ std::shared\_ptr<ClassType>(Clone());}
\DoxyCodeLine{00381\ }
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ the\ delegate\ message}}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ msg\ =\ std::make\_shared<\mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_msg}{DelegateAsyncMsg}}<Args...>>(delegate,\ args...);}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Dispatch\ message\ onto\ the\ callback\ destination\ thread.\ DelegateInvoke()}}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ will\ be\ called\ by\ the\ destintation\ thread.\ }}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \ \ \ \ GetThread().DispatchDelegate(msg);}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Do\ not\ wait\ for\ destination\ thread\ return\ value\ from\ async\ function\ call}}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ RetType();}
\DoxyCodeLine{00391\ }
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Check\ if\ any\ argument\ is\ a\ shared\_ptr\ with\ wrong\ usage}}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ std::shared\_ptr\ reference\ arguments\ are\ not\ allowed\ with\ asynchronous\ delegates\ as\ the\ behavior\ is\ }}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ undefined.\ In\ other\ words:}}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ void\ MyFunc(std::shared\_ptr<T>\ data)\ \ \ \ \ //\ Ok!}}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ void\ MyFunc(std::shared\_ptr<T>\&\ data)\ \ \ \ //\ Error\ if\ DelegateAsync\ or\ DelegateSpAsync\ target!}}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_assert}(!(std::disjunction\_v<is\_shared\_ptr<Args>...>\ \&\&}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (std::disjunction\_v<std::is\_lvalue\_reference<Args>,\ std::is\_pointer<Args>>\ ||\ ...)),}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}std::shared\_ptr\ reference\ argument\ not\ allowed"{}});}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00401\ \ \ \ \ \}}
\DoxyCodeLine{00402\ }
\DoxyCodeLine{00403\ \ \ \ \ \textcolor{comment}{//\ Invoke\ delegate\ function\ asynchronously.\ Do\ not\ wait\ for\ return\ value,\ if\ any.}}
\DoxyCodeLine{00404\ \ \ \ \ \textcolor{comment}{//\ Called\ by\ the\ source\ thread.}}
\DoxyCodeLine{00405\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_aa1b8f9b21955f6d398fab9ad1153f940}{AsyncInvoke}}(Args...\ args)\ \{}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ operator()(args...);\ \ \ }
\DoxyCodeLine{00407\ \ \ \ \ \}}
\DoxyCodeLine{00408\ }
\DoxyCodeLine{00409\ \ \ \ \ \textcolor{comment}{//\ Invoke\ the\ delegate\ function\ on\ the\ destination\ thread.\ Each\ source\ thread\ call}}
\DoxyCodeLine{00410\ \ \ \ \ \textcolor{comment}{//\ to\ operator()\ generate\ a\ call\ to\ DelegateInvoke()\ on\ the\ destination\ thread.\ }}
\DoxyCodeLine{00411\ \ \ \ \ \textcolor{comment}{//\ Unlike\ DelegateAsyncWait,\ a\ lock\ is\ not\ required\ between\ source\ and\ destination\ }}
\DoxyCodeLine{00412\ \ \ \ \ \textcolor{comment}{//\ delegateMsg\ access\ because\ the\ source\ thread\ is\ not\ waiting\ for\ the\ function\ call\ }}
\DoxyCodeLine{00413\ \ \ \ \ \textcolor{comment}{//\ to\ complete.}}
\DoxyCodeLine{00414\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a2402ad65efec989ec7d9bc671ec066ae}{DelegateInvoke}}(std::shared\_ptr<DelegateMsg>\ msg)\ \{}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Typecast\ the\ base\ pointer\ to\ back\ correct\ derived\ to\ instance}}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ delegateMsg\ =\ std::dynamic\_pointer\_cast<\mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_msg}{DelegateAsyncMsg}}<Args...>>(msg);}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (delegateMsg\ ==\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Invalid\ DelegateMsgHeapArgs\ cast"{}});}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Invoke\ the\ delegate\ function\ asynchronously}}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ SetSync(\textcolor{keyword}{true});}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ std::apply(\&BaseType::operator(),\ }
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \ \ \ \ std::tuple\_cat(std::make\_tuple(\textcolor{keyword}{this}),\ delegateMsg-\/>GetArgs()));}
\DoxyCodeLine{00424\ \ \ \ \ \}}
\DoxyCodeLine{00425\ }
\DoxyCodeLine{00426\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ destination\ thread\ that\ the\ target\ function\ is\ invoked\ on}}
\DoxyCodeLine{00427\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a9cb866c89077cbd0e55a22e8bcbb321a}{GetThread}}()\ \{\ \textcolor{keywordflow}{return}\ m\_thread;\ \}}
\DoxyCodeLine{00428\ }
\DoxyCodeLine{00429\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00430\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a469f4b8d8536cfc049d4767fffdd3a15}{GetSync}}()\ \{\ \textcolor{keywordflow}{return}\ m\_sync;\ \}}
\DoxyCodeLine{00431\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a21431c52f8e2a17316aa2a97e0e23cc2}{SetSync}}(\textcolor{keywordtype}{bool}\ sync)\ \{\ m\_sync\ =\ sync;\ \}}
\DoxyCodeLine{00432\ }
\DoxyCodeLine{00433\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00434\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ m\_thread;\ \ \ \textcolor{comment}{//\ The\ target\ thread\ to\ invoke\ the\ delegate\ function.}}
\DoxyCodeLine{00435\ \ \ \ \ \textcolor{keywordtype}{bool}\ m\_sync\ =\ \textcolor{keyword}{false};\ \ \ \ \ \ \ \ \textcolor{comment}{//\ Flag\ to\ control\ synchronous\ vs\ asynchronous\ behavior.}}
\DoxyCodeLine{00436\ \ \ \ \ \textcolor{comment}{//\ </common\_code>}}
\DoxyCodeLine{00437\ \};}
\DoxyCodeLine{00438\ }
\DoxyCodeLine{00439\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ R>}
\DoxyCodeLine{00440\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_delegate_lib_1_1_delegate_function_async}{DelegateFunctionAsync}};\ \textcolor{comment}{//\ Not\ defined}}
\DoxyCodeLine{00441\ }
\DoxyCodeLine{00442\ \textcolor{comment}{//\ DelegateFunctionAsync\ class\ asynchronously\ invokes\ a\ std::function\ target\ function.}}
\DoxyCodeLine{00443\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }RetType,\ \textcolor{keyword}{class}...\ Args>}
\DoxyCodeLine{00444\ \textcolor{keyword}{class\ }\mbox{\hyperlink{struct_delegate_lib_1_1_delegate_function_async}{DelegateFunctionAsync}}<RetType(Args...)>\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function}{DelegateFunction}}<RetType(Args...)>,\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_delegate_lib_1_1_i_delegate_invoker}{IDelegateInvoker}}\ \{}
\DoxyCodeLine{00445\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00446\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4_a4002625654c02248b5b37266bf63ef66}{FunctionType}}\ =\ std::function<RetType(Args...)>;}
\DoxyCodeLine{00447\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\ =\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_function_async}{DelegateFunctionAsync}}<RetType(Args...)>;}
\DoxyCodeLine{00448\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_3_01_ret_type_07_args_8_8_8_08_4}{BaseType}}\ =\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function}{DelegateFunction}}<RetType(Args...)>;}
\DoxyCodeLine{00449\ }
\DoxyCodeLine{00450\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4_a46501e1a3392ed1d13e3f3cba8eb2df0}{DelegateFunctionAsync}}(\mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4_a4002625654c02248b5b37266bf63ef66}{FunctionType}}\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread)\ :}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_3_01_ret_type_07_args_8_8_8_08_4}{BaseType}}(func),\ m\_thread(thread)\ \{}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ Bind(func,\ thread);}
\DoxyCodeLine{00453\ \ \ \ \ \}}
\DoxyCodeLine{00454\ }
\DoxyCodeLine{00455\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4_a2fb983602c9e3fcecc54907f13b748ce}{DelegateFunctionAsync}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ rhs)\ :}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_3_01_ret_type_07_args_8_8_8_08_4}{BaseType}}(rhs),\ m\_thread(rhs.m\_thread)\ \{}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ Assign(rhs);}
\DoxyCodeLine{00458\ \ \ \ \ \}}
\DoxyCodeLine{00459\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4_ae32a58387b3b00e002763f3244310fab}{DelegateFunctionAsync}}()\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00460\ }
\DoxyCodeLine{00461\ \ \ \ \ \textcolor{comment}{//\ Bind\ a\ std::function\ to\ the\ delegate.}}
\DoxyCodeLine{00462\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4_a56758d6e931fbff1cfc3ea97151fd6b5}{Bind}}(\mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4_a4002625654c02248b5b37266bf63ef66}{FunctionType}}\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread)\ \{}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ m\_thread\ =\ thread;}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ BaseType::Bind(func);}
\DoxyCodeLine{00465\ \ \ \ \ \}}
\DoxyCodeLine{00466\ }
\DoxyCodeLine{00467\ \ \ \ \ \textcolor{comment}{//\ <common\_code>}}
\DoxyCodeLine{00468\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4_ae51e00822c91e01e7041be385ac38c76}{Assign}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ rhs)\ \{}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ m\_thread\ =\ rhs.m\_thread;}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ BaseType::Assign(rhs);}
\DoxyCodeLine{00471\ \ \ \ \ \}}
\DoxyCodeLine{00472\ }
\DoxyCodeLine{00473\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}*\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4_a12be5d3ae814bea5de0df73d2807bedd}{Clone}}()\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{00474\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{00475\ \ \ \ \ \}}
\DoxyCodeLine{00476\ }
\DoxyCodeLine{00477\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4_a203dd774ded780851f79cac05c4c719b}{operator=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ rhs)\ \{}
\DoxyCodeLine{00478\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\&rhs\ !=\ \textcolor{keyword}{this})\ \{}
\DoxyCodeLine{00479\ \ \ \ \ \ \ \ \ \ \ \ \ BaseType::operator=(rhs);}
\DoxyCodeLine{00480\ \ \ \ \ \ \ \ \ \ \ \ \ Assign(rhs);}
\DoxyCodeLine{00481\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00483\ \ \ \ \ \}}
\DoxyCodeLine{00484\ }
\DoxyCodeLine{00485\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4_a642fc55c2dfa6f7eb29f016a7194af9a}{operator==}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_base}{DelegateBase}}\&\ rhs)\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ derivedRhs\ =\ \textcolor{keyword}{dynamic\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}*\textcolor{keyword}{>}(\&rhs);}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ derivedRhs\ \&\&}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \ \ \ \ \&m\_thread\ ==\ \&derivedRhs-\/>m\_thread\ \&\&}
\DoxyCodeLine{00489\ \ \ \ \ \ \ \ \ \ \ \ \ BaseType::operator==(rhs);}
\DoxyCodeLine{00490\ \ \ \ \ \}}
\DoxyCodeLine{00491\ }
\DoxyCodeLine{00492\ \ \ \ \ \textcolor{comment}{//\ Invoke\ delegate\ function\ asynchronously.\ Do\ not\ wait\ for\ return\ value,\ if\ any.}}
\DoxyCodeLine{00493\ \ \ \ \ \textcolor{comment}{//\ Called\ by\ the\ source\ thread.\ Dispatches\ the\ delegate\ data\ into\ the\ destination\ }}
\DoxyCodeLine{00494\ \ \ \ \ \textcolor{comment}{//\ thread\ message\ queue.\ DelegateInvoke()\ must\ be\ called\ by\ the\ destination\ thread\ }}
\DoxyCodeLine{00495\ \ \ \ \ \textcolor{comment}{//\ to\ invoke\ the\ target\ function.}}
\DoxyCodeLine{00496\ \ \ \ \ \textcolor{keyword}{virtual}\ RetType\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4_a1e6153da03f3d607b1e18deb391c04a4}{operator()}}(Args...\ args)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>GetSync())}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ BaseType::operator()(args...);}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ a\ clone\ instance\ of\ this\ delegate\ }}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ delegate\ =\ std::shared\_ptr<ClassType>(Clone());}
\DoxyCodeLine{00503\ }
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ the\ delegate\ message}}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ msg\ =\ std::make\_shared<\mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_msg}{DelegateAsyncMsg}}<Args...>>(delegate,\ args...);}
\DoxyCodeLine{00506\ }
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Dispatch\ message\ onto\ the\ callback\ destination\ thread.\ DelegateInvoke()}}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ will\ be\ called\ by\ the\ destintation\ thread.\ }}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ \ \ \ \ GetThread().DispatchDelegate(msg);}
\DoxyCodeLine{00510\ }
\DoxyCodeLine{00511\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Do\ not\ wait\ for\ destination\ thread\ return\ value\ from\ async\ function\ call}}
\DoxyCodeLine{00512\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ RetType();}
\DoxyCodeLine{00513\ }
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Check\ if\ any\ argument\ is\ a\ shared\_ptr\ with\ wrong\ usage}}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ std::shared\_ptr\ reference\ arguments\ are\ not\ allowed\ with\ asynchronous\ delegates\ as\ the\ behavior\ is\ }}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ undefined.\ In\ other\ words:}}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ void\ MyFunc(std::shared\_ptr<T>\ data)\ \ \ \ \ //\ Ok!}}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ void\ MyFunc(std::shared\_ptr<T>\&\ data)\ \ \ \ //\ Error\ if\ DelegateAsync\ or\ DelegateSpAsync\ target!}}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_assert}(!(std::disjunction\_v<is\_shared\_ptr<Args>...>\ \&\&}
\DoxyCodeLine{00520\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (std::disjunction\_v<std::is\_lvalue\_reference<Args>,\ std::is\_pointer<Args>>\ ||\ ...)),}
\DoxyCodeLine{00521\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}std::shared\_ptr\ reference\ argument\ not\ allowed"{}});}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00523\ \ \ \ \ \}}
\DoxyCodeLine{00524\ }
\DoxyCodeLine{00525\ \ \ \ \ \textcolor{comment}{//\ Invoke\ delegate\ function\ asynchronously.\ Do\ not\ wait\ for\ return\ value,\ if\ any.}}
\DoxyCodeLine{00526\ \ \ \ \ \textcolor{comment}{//\ Called\ by\ the\ source\ thread.}}
\DoxyCodeLine{00527\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4_a5c0e0c2591b0b02feec73b501325fcb6}{AsyncInvoke}}(Args...\ args)\ \{}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \ \ operator()(args...);\ \ \ }
\DoxyCodeLine{00529\ \ \ \ \ \}}
\DoxyCodeLine{00530\ }
\DoxyCodeLine{00531\ \ \ \ \ \textcolor{comment}{//\ Invoke\ the\ delegate\ function\ on\ the\ destination\ thread.\ Each\ source\ thread\ call}}
\DoxyCodeLine{00532\ \ \ \ \ \textcolor{comment}{//\ to\ operator()\ generate\ a\ call\ to\ DelegateInvoke()\ on\ the\ destination\ thread.\ }}
\DoxyCodeLine{00533\ \ \ \ \ \textcolor{comment}{//\ Unlike\ DelegateAsyncWait,\ a\ lock\ is\ not\ required\ between\ source\ and\ destination\ }}
\DoxyCodeLine{00534\ \ \ \ \ \textcolor{comment}{//\ delegateMsg\ access\ because\ the\ source\ thread\ is\ not\ waiting\ for\ the\ function\ call\ }}
\DoxyCodeLine{00535\ \ \ \ \ \textcolor{comment}{//\ to\ complete.}}
\DoxyCodeLine{00536\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4_a56930924ffa7d6662874675263e89bc5}{DelegateInvoke}}(std::shared\_ptr<DelegateMsg>\ msg)\ \{}
\DoxyCodeLine{00537\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Typecast\ the\ base\ pointer\ to\ back\ correct\ derived\ to\ instance}}
\DoxyCodeLine{00538\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ delegateMsg\ =\ std::dynamic\_pointer\_cast<\mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_msg}{DelegateAsyncMsg}}<Args...>>(msg);}
\DoxyCodeLine{00539\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (delegateMsg\ ==\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00540\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Invalid\ DelegateMsgHeapArgs\ cast"{}});}
\DoxyCodeLine{00541\ }
\DoxyCodeLine{00542\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Invoke\ the\ delegate\ function\ asynchronously}}
\DoxyCodeLine{00543\ \ \ \ \ \ \ \ \ SetSync(\textcolor{keyword}{true});}
\DoxyCodeLine{00544\ \ \ \ \ \ \ \ \ std::apply(\&BaseType::operator(),\ }
\DoxyCodeLine{00545\ \ \ \ \ \ \ \ \ \ \ \ \ std::tuple\_cat(std::make\_tuple(\textcolor{keyword}{this}),\ delegateMsg-\/>GetArgs()));}
\DoxyCodeLine{00546\ \ \ \ \ \}}
\DoxyCodeLine{00547\ }
\DoxyCodeLine{00548\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ destination\ thread\ that\ the\ target\ function\ is\ invoked\ on}}
\DoxyCodeLine{00549\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4_a4ffeb3f53371220821da54b9303d5bed}{GetThread}}()\ \{\ \textcolor{keywordflow}{return}\ m\_thread;\ \}}
\DoxyCodeLine{00550\ }
\DoxyCodeLine{00551\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00552\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4_a24d22901f60ab741597e253b7f02c174}{GetSync}}()\ \{\ \textcolor{keywordflow}{return}\ m\_sync;\ \}}
\DoxyCodeLine{00553\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4_acf44f40ff48ec3f1481b6dca4e08c352}{SetSync}}(\textcolor{keywordtype}{bool}\ sync)\ \{\ m\_sync\ =\ sync;\ \}}
\DoxyCodeLine{00554\ }
\DoxyCodeLine{00555\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00556\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ m\_thread;\ \ \ \textcolor{comment}{//\ The\ target\ thread\ to\ invoke\ the\ delegate\ function.}}
\DoxyCodeLine{00557\ \ \ \ \ \textcolor{keywordtype}{bool}\ m\_sync\ =\ \textcolor{keyword}{false};\ \ \ \ \ \ \ \ \textcolor{comment}{//\ Flag\ to\ control\ synchronous\ vs\ asynchronous\ behavior.}}
\DoxyCodeLine{00558\ \ \ \ \ \textcolor{comment}{//\ </common\_code>}}
\DoxyCodeLine{00559\ \};}
\DoxyCodeLine{00560\ }
\DoxyCodeLine{00561\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }RetType,\ \textcolor{keyword}{class}...\ Args>}
\DoxyCodeLine{00562\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_free_async}{DelegateFreeAsync}}<RetType(Args...)>\ \mbox{\hyperlink{namespace_delegate_lib_a75ff1e13f1cb691402002bfccaf9d1b2}{MakeDelegate}}(RetType(*func)(Args...\ args),\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread)\ \{}
\DoxyCodeLine{00563\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_free_async}{DelegateFreeAsync}}<RetType(Args...)>(func,\ thread);}
\DoxyCodeLine{00564\ \}}
\DoxyCodeLine{00565\ }
\DoxyCodeLine{00566\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }TClass,\ \textcolor{keyword}{class\ }RetType,\ \textcolor{keyword}{class}...\ Args>}
\DoxyCodeLine{00567\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_async}{DelegateMemberAsync}}<TClass,\ RetType(Args...)>\ \mbox{\hyperlink{namespace_delegate_lib_a75ff1e13f1cb691402002bfccaf9d1b2}{MakeDelegate}}(TClass*\ \textcolor{keywordtype}{object},\ RetType(TClass::*\ func)(Args...\ args),\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread)\ \{}
\DoxyCodeLine{00568\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_async}{DelegateMemberAsync}}<TClass,\ RetType(Args...)>(object,\ func,\ thread);}
\DoxyCodeLine{00569\ \}}
\DoxyCodeLine{00570\ }
\DoxyCodeLine{00571\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }TClass,\ \textcolor{keyword}{class\ }RetType,\ \textcolor{keyword}{class}...\ Args>}
\DoxyCodeLine{00572\ DelegateMemberAsync<TClass,\ RetType(Args...)>\ \mbox{\hyperlink{namespace_delegate_lib_a75ff1e13f1cb691402002bfccaf9d1b2}{MakeDelegate}}(TClass*\ \textcolor{keywordtype}{object},\ RetType(TClass::*\ func)(Args...\ args)\ \textcolor{keyword}{const},\ DelegateThread\&\ thread)\ \{}
\DoxyCodeLine{00573\ \ \ \ \ \textcolor{keywordflow}{return}\ DelegateMemberAsync<TClass,\ RetType(Args...)>(object,\ func,\ thread);}
\DoxyCodeLine{00574\ \}}
\DoxyCodeLine{00575\ }
\DoxyCodeLine{00576\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }TClass,\ \textcolor{keyword}{class\ }RetVal,\ \textcolor{keyword}{class}...\ Args>}
\DoxyCodeLine{00577\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_sp_async}{DelegateMemberSpAsync}}<TClass,\ RetVal(Args...)>\ \mbox{\hyperlink{namespace_delegate_lib_a75ff1e13f1cb691402002bfccaf9d1b2}{MakeDelegate}}(std::shared\_ptr<TClass>\ \textcolor{keywordtype}{object},\ RetVal(TClass::*\ func)(Args...\ args),\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread)\ \{}
\DoxyCodeLine{00578\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_sp_async}{DelegateMemberSpAsync}}<TClass,\ RetVal(Args...)>(object,\ func,\ thread);}
\DoxyCodeLine{00579\ \}}
\DoxyCodeLine{00580\ }
\DoxyCodeLine{00581\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }TClass,\ \textcolor{keyword}{class\ }RetVal,\ \textcolor{keyword}{class}...\ Args>}
\DoxyCodeLine{00582\ DelegateMemberSpAsync<TClass,\ RetVal(Args...)>\ \mbox{\hyperlink{namespace_delegate_lib_a75ff1e13f1cb691402002bfccaf9d1b2}{MakeDelegate}}(std::shared\_ptr<TClass>\ \textcolor{keywordtype}{object},\ RetVal(TClass::*\ func)(Args...\ args)\ \textcolor{keyword}{const},\ DelegateThread\&\ thread)\ \{}
\DoxyCodeLine{00583\ \ \ \ \ \textcolor{keywordflow}{return}\ DelegateMemberSpAsync<TClass,\ RetVal(Args...)>(object,\ func,\ thread);}
\DoxyCodeLine{00584\ \}}
\DoxyCodeLine{00585\ }
\DoxyCodeLine{00586\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }RetType,\ \textcolor{keyword}{class}...\ Args>}
\DoxyCodeLine{00587\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_function_async}{DelegateFunctionAsync}}<RetType(Args...)>\ \mbox{\hyperlink{namespace_delegate_lib_a75ff1e13f1cb691402002bfccaf9d1b2}{MakeDelegate}}(std::function<RetType(Args...)>\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread)\ \{}
\DoxyCodeLine{00588\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_function_async}{DelegateFunctionAsync}}<RetType(Args...)>(func,\ thread);}
\DoxyCodeLine{00589\ \}}
\DoxyCodeLine{00590\ }
\DoxyCodeLine{00591\ \}}
\DoxyCodeLine{00592\ }
\DoxyCodeLine{00593\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
