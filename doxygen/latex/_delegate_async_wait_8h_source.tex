\doxysection{Delegate\+Async\+Wait.\+h}
\hypertarget{_delegate_async_wait_8h_source}{}\label{_delegate_async_wait_8h_source}\index{C:/Projects/AsyncMulticastDelegateModern/src/Delegate/DelegateAsyncWait.h@{C:/Projects/AsyncMulticastDelegateModern/src/Delegate/DelegateAsyncWait.h}}
\mbox{\hyperlink{_delegate_async_wait_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ \_DELEGATE\_ASYNC\_WAIT\_H}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ \_DELEGATE\_ASYNC\_WAIT\_H}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{comment}{//\ DelegateAsyncWait.h}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ @see\ https://github.com/endurodave/AsyncMulticastDelegateModern}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ David\ Lafreniere,\ Aug\ 2020.}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_delegate_async_8h}{DelegateAsync.h}}"{}}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_delegate_thread_8h}{DelegateThread.h}}"{}}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_delegate_invoker_8h}{DelegateInvoker.h}}"{}}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <optional>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <any>}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <chrono>}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{comment}{//\ Asynchronous\ delegate\ that\ invokes\ the\ target\ function\ on\ the\ specified\ thread\ of\ control}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ and\ waits\ for\ the\ function\ to\ be\ executed\ or\ a\ timeout\ occurs.\ Use\ IsSuccess()\ to\ determine\ if\ }}
\DoxyCodeLine{00017\ \textcolor{comment}{//\ asynchronous\ call\ succeeded.}}
\DoxyCodeLine{00018\ \textcolor{comment}{//\ }}
\DoxyCodeLine{00019\ \textcolor{comment}{//\ Delegate\ "{}AsyncWait"{}\ series\ of\ classes\ used\ to\ invoke\ a\ function\ asynchronously\ and\ wait\ for\ }}
\DoxyCodeLine{00020\ \textcolor{comment}{//\ completion\ by\ the\ destination\ target\ thread.\ Invoking\ a\ function\ asynchronously\ requires\ making\ }}
\DoxyCodeLine{00021\ \textcolor{comment}{//\ a\ clone\ of\ the\ object\ to\ be\ sent\ to\ the\ destination\ thread\ message\ queue.\ The\ destination\ thread\ }}
\DoxyCodeLine{00022\ \textcolor{comment}{//\ calls\ DelegateInvoke()\ to\ invoke\ the\ target\ function.\ The\ source\ thread\ blocks\ on\ a\ semaphore\ }}
\DoxyCodeLine{00023\ \textcolor{comment}{//\ waiting\ for\ the\ destination\ thread\ to\ complete\ the\ function\ invoke.\ If\ the\ caller\ timeout\ expires,\ }}
\DoxyCodeLine{00024\ \textcolor{comment}{//\ the\ target\ function\ is\ not\ invoked.\ }}
\DoxyCodeLine{00025\ \textcolor{comment}{//\ }}
\DoxyCodeLine{00026\ \textcolor{comment}{//\ The\ m\_lock\ mutex\ is\ used\ to\ protect\ shared\ state\ data\ between\ the\ source\ and\ destination\ }}
\DoxyCodeLine{00027\ \textcolor{comment}{//\ threads\ using\ the\ two\ thread\ safe\ functions\ below:}}
\DoxyCodeLine{00028\ \textcolor{comment}{//}}
\DoxyCodeLine{00029\ \textcolor{comment}{//\ RetType\ operator()(Args...\ args)\ -\/\ called\ by\ the\ source\ thread\ to\ initiate\ the\ async}}
\DoxyCodeLine{00030\ \textcolor{comment}{//\ function\ call.}}
\DoxyCodeLine{00031\ \textcolor{comment}{//}}
\DoxyCodeLine{00032\ \textcolor{comment}{//\ void\ DelegateInvoke(std::shared\_ptr<DelegateMsg>\ msg)\ -\/\ called\ by\ the\ destination}}
\DoxyCodeLine{00033\ \textcolor{comment}{//\ thread\ to\ invoke\ the\ target\ function.\ The\ destination\ thread\ must\ not\ call\ any\ other}}
\DoxyCodeLine{00034\ \textcolor{comment}{//\ delegate\ instance\ functions.}}
\DoxyCodeLine{00035\ \textcolor{comment}{//}}
\DoxyCodeLine{00036\ \textcolor{comment}{//\ Code\ within\ <common\_code>\ and\ </common\_code>\ is\ updated\ using\ sync\_src.py.\ Manually\ update\ }}
\DoxyCodeLine{00037\ \textcolor{comment}{//\ the\ code\ within\ the\ DelegateFreeAsyncWait\ common\_code\ tags,\ then\ run\ the\ script\ to\ }}
\DoxyCodeLine{00038\ \textcolor{comment}{//\ propagate\ to\ the\ remaining\ delegate\ classes\ to\ simplify\ code\ maintenance.}}
\DoxyCodeLine{00039\ \textcolor{comment}{//\ }}
\DoxyCodeLine{00040\ \textcolor{comment}{//\ python\ src\_dup.py\ DelegateAsyncWait.h}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_delegate_lib}{DelegateLib}}\ \{}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#undef\ max\ \ }\textcolor{comment}{//\ Prevent\ compiler\ error\ on\ next\ line\ if\ max\ is\ defined}}
\DoxyCodeLine{00045\ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespace_delegate_lib_aa0e7491d38d4053d6218bf874d56e868}{WAIT\_INFINITE}}\ =\ std::chrono::milliseconds::max();}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00049\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}...Args>}
\DoxyCodeLine{00050\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_wait_msg}{DelegateAsyncWaitMsg}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_msg}{DelegateMsg}}}
\DoxyCodeLine{00051\ \{}
\DoxyCodeLine{00052\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00056\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_wait_msg_afc2f62926faf9d0537d2b953e6fd2d91}{DelegateAsyncWaitMsg}}(std::shared\_ptr<IDelegateInvoker>\ invoker,\ Args...\ args)\ :\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_msg}{DelegateMsg}}(invoker),}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ m\_args(args...)}
\DoxyCodeLine{00058\ \ \ \ \ \{}
\DoxyCodeLine{00059\ \ \ \ \ \}}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_wait_msg_afba165a7c2d99e3245ae0046a5d4cb1a}{\string~DelegateAsyncWaitMsg}}()\ \{\}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00065\ \ \ \ \ std::tuple<Args...>\&\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_wait_msg_a40e395855b723495c3f9aea2ef2eec6f}{GetArgs}}()\ \{\ \textcolor{keywordflow}{return}\ m\_args;\ \}}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ semaphore\ used\ to\ signal\ the\ sending\ thread\ that\ the\ receiving\ }}
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{comment}{//\ thread\ has\ invoked\ the\ target\ function.\ }}
\DoxyCodeLine{00069\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_semaphore}{Semaphore}}\&\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_wait_msg_a6730a8609639d49721dbe2389971e3bb}{GetSema}}()\ \{\ \textcolor{keywordflow}{return}\ m\_sema;\ \}}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{comment}{//\ Get\ a\ mutex\ shared\ between\ sender\ and\ receiver\ threads}}
\DoxyCodeLine{00072\ \ \ \ \ std::mutex\&\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_wait_msg_ac8ca2d43973ccf4141747494448cd930}{GetLock}}()\ \{\ \textcolor{keywordflow}{return}\ m\_lock;\ \}}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{comment}{//\ True\ if\ the\ sending\ thread\ is\ waiting\ for\ the\ receiver\ thread\ to\ call\ the\ function.}}
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{comment}{//\ False\ if\ the\ sending\ thread\ delegate\ timeout\ occurred\ and\ is\ not\ waiting.}}
\DoxyCodeLine{00076\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_wait_msg_ae36cc3b75be6d2698213ef25c43ad390}{GetInvokerWaiting}}()\ \{\ \textcolor{keywordflow}{return}\ m\_invokerWaiting;\ \}}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{comment}{//\ Set\ to\ true\ when\ source\ thread\ is\ waiting\ for\ destination\ thread\ to\ complete\ the\ }}
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{comment}{//\ function\ call.}}
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_wait_msg_a9a8287c553329db52f3710863a318023}{SetInvokerWaiting}}(\textcolor{keywordtype}{bool}\ invokerWaiting)\ \{\ m\_invokerWaiting\ =\ invokerWaiting;\ \}}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00084\ \ \ \ \ std::tuple<>\ m\_start;}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00087\ \ \ \ \ std::tuple<Args...>\ m\_args;}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_semaphore}{Semaphore}}\ m\_sema;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Semaphore\ to\ signal\ waiting\ thread}}
\DoxyCodeLine{00090\ \ \ \ \ std::mutex\ m\_lock;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Lock\ to\ protect\ shared\ data\ \ }}
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{keywordtype}{bool}\ m\_invokerWaiting\ =\ \textcolor{keyword}{false};\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ True\ if\ caller\ thread\ is\ waiting\ for\ invoke\ complete}}
\DoxyCodeLine{00092\ \};}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ R>}
\DoxyCodeLine{00095\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_delegate_lib_1_1_delegate_free_async_wait}{DelegateFreeAsyncWait}};\ \textcolor{comment}{//\ Not\ defined}}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \textcolor{comment}{//\ DelegateFreeAsyncWait\ class\ asynchronously\ block\ invokes\ a\ free\ target\ function.}}
\DoxyCodeLine{00098\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }RetType,\ \textcolor{keyword}{class}...\ Args>}
\DoxyCodeLine{00099\ \textcolor{keyword}{class\ }\mbox{\hyperlink{struct_delegate_lib_1_1_delegate_free_async_wait}{DelegateFreeAsyncWait}}<RetType(Args...)>\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_free_async}{DelegateFreeAsync}}<RetType(Args...)>\ \{}
\DoxyCodeLine{00100\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keyword}{typedef}\ RetType(*FreeFunc)(Args...);}
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_wait_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\ =\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_free_async_wait}{DelegateFreeAsyncWait}}<RetType(Args...)>;}
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4}{BaseType}}\ =\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_free_async}{DelegateFreeAsync}}<RetType(Args...)>;}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{comment}{//\ Contructors\ take\ a\ free\ function,\ delegate\ thread\ and\ timeout}}
\DoxyCodeLine{00106\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_wait_3_01_ret_type_07_args_8_8_8_08_4_a7fb45bfb235c1179c198c8f594179a13}{DelegateFreeAsyncWait}}(FreeFunc\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread,\ std::chrono::milliseconds\ timeout)\ :}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4}{BaseType}}(func,\ thread),\ m\_timeout(timeout)\ \{}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ Bind(func,\ thread);}
\DoxyCodeLine{00109\ \ \ \ \ \}}
\DoxyCodeLine{00110\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_wait_3_01_ret_type_07_args_8_8_8_08_4_a0548bcb02ed5a326786b2ae237fedc3c}{DelegateFreeAsyncWait}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_wait_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ rhs)\ :}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_3_01_ret_type_07_args_8_8_8_08_4}{BaseType}}(rhs)\ \{}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ Assign(rhs);}
\DoxyCodeLine{00113\ \ \ \ \ \}}
\DoxyCodeLine{00114\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_wait_3_01_ret_type_07_args_8_8_8_08_4_a1818f2fdb4605093b52d0d19b3aef5fa}{DelegateFreeAsyncWait}}()\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_wait_3_01_ret_type_07_args_8_8_8_08_4_a8e036665e5b6f1ef58e7fc745d7a9542}{Bind}}(FreeFunc\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread)\ \{}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ BaseType::Bind(func,\ thread);}
\DoxyCodeLine{00119\ \ \ \ \ \}}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \ \ \textcolor{comment}{//\ <common\_code>}}
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_wait_3_01_ret_type_07_args_8_8_8_08_4_ae495a55e908778e619d186eb9afb9ecc}{Assign}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_wait_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ rhs)\ \{}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ m\_timeout\ =\ rhs.m\_timeout;}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ BaseType::Assign(rhs);}
\DoxyCodeLine{00125\ \ \ \ \ \}}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_wait_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}*\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_wait_3_01_ret_type_07_args_8_8_8_08_4_ac4e2726464bd640ef6c7993afe95e1ca}{Clone}}()\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_wait_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{00129\ \ \ \ \ \}}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_wait_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_wait_3_01_ret_type_07_args_8_8_8_08_4_ad01b49b6d7d19754b2baf7690fae8820}{operator=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_wait_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ rhs)\ \{}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\&rhs\ !=\ \textcolor{keyword}{this})\ \{}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ BaseType::operator=(rhs);}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ Assign(rhs);}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00137\ \ \ \ \ \}}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_wait_3_01_ret_type_07_args_8_8_8_08_4_ae92c9a822eb76f710468e400d22847c9}{operator==}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_base}{DelegateBase}}\&\ rhs)\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ derivedRhs\ =\ \textcolor{keyword}{dynamic\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_wait_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}*\textcolor{keyword}{>}(\&rhs);}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ derivedRhs\ \&\&}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ m\_timeout\ ==\ derivedRhs-\/>m\_timeout\ \&\&}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \ \ BaseType::operator==(rhs);}
\DoxyCodeLine{00144\ \ \ \ \ \}}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{comment}{//\ Invoke\ delegate\ function\ asynchronously\ and\ block\ for\ function\ return\ value.\ }}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{comment}{//\ Called\ by\ the\ source\ thread.\ Dispatches\ the\ delegate\ data\ into\ the\ destination\ }}
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{comment}{//\ thread\ message\ queue.\ DelegateInvoke()\ must\ be\ called\ by\ the\ destination\ thread\ }}
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{comment}{//\ to\ invoke\ the\ target\ function.}}
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{keyword}{virtual}\ RetType\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_wait_3_01_ret_type_07_args_8_8_8_08_4_a79322ee2599e067f1be1ed9f803bb211}{operator()}}(Args...\ args)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>GetSync())}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ BaseType::operator()(args...);}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ a\ clone\ instance\ of\ this\ delegate\ }}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ delegate\ =\ std::shared\_ptr<ClassType>(Clone());}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ a\ new\ message\ instance\ }}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ msg\ =\ std::make\_shared<\mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_wait_msg}{DelegateAsyncWaitMsg}}<Args...>>(delegate,\ args...);}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \ \ \ \ msg-\/>\mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_wait_msg_a9a8287c553329db52f3710863a318023}{SetInvokerWaiting}}(\textcolor{keyword}{true});}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Dispatch\ message\ onto\ the\ callback\ destination\ thread.\ DelegateInvoke()}}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ will\ be\ called\ by\ the\ destination\ thread.\ }}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>GetThread().DispatchDelegate(msg);}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Wait\ for\ destination\ thread\ to\ execute\ the\ delegate\ function\ and\ get\ return\ value}}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((m\_success\ =\ msg-\/>GetSema().Wait(m\_timeout)))}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_retVal\ =\ delegate-\/>m\_retVal;}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Protect\ data\ shared\ between\ source\ and\ destination\ threads}}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::lock\_guard<std::mutex>\ lock(msg-\/>GetLock());}
\DoxyCodeLine{00172\ }
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ flag\ that\ source\ is\ not\ waiting\ anymore}}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \ \ msg-\/>SetInvokerWaiting(\textcolor{keyword}{false});}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Return\ the\ destintation\ thread\ return\ value,\ if\ any}}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_void<RetType>::value\ ==\ \textcolor{keyword}{false})}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_retVal.has\_value())}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::any\_cast<RetType>(m\_retVal);}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ RetType();}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00185\ \ \ \ \ \}}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \ \ \textcolor{comment}{//\ Invoke\ delegate\ function\ asynchronously\ and\ block\ for\ function\ return\ value.}}
\DoxyCodeLine{00188\ \ \ \ \ \textcolor{comment}{//\ Called\ by\ the\ source\ thread.}}
\DoxyCodeLine{00189\ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_wait_3_01_ret_type_07_args_8_8_8_08_4_acca23e7595f55d4509625332f650de8f}{AsyncInvoke}}(Args...\ args)\ \{}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_void<RetType>::value\ ==\ \textcolor{keyword}{true})}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ operator()(args...);}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ IsSuccess()\ ?\ std::optional<bool>(\textcolor{keyword}{true})\ :\ std::optional<bool>();}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ retVal\ =\ operator()(args...);}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ IsSuccess()\ ?\ std::optional<RetType>(retVal)\ :\ std::optional<RetType>();}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00200\ \ \ \ \ \}}
\DoxyCodeLine{00201\ }
\DoxyCodeLine{00202\ \ \ \ \ \textcolor{comment}{//\ Invoke\ the\ delegate\ function\ on\ the\ destination\ thread.\ Each\ source\ thread\ call}}
\DoxyCodeLine{00203\ \ \ \ \ \textcolor{comment}{//\ to\ operator()\ generate\ a\ call\ to\ DelegateInvoke()\ on\ the\ destination\ thread.\ A\ }}
\DoxyCodeLine{00204\ \ \ \ \ \textcolor{comment}{//\ lock\ provides\ thread\ safety\ between\ source\ and\ destination\ delegateMsg\ thread\ access.}}
\DoxyCodeLine{00205\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_wait_3_01_ret_type_07_args_8_8_8_08_4_aeca8d0211d34404e9fd2ecb4d0d356b9}{DelegateInvoke}}(std::shared\_ptr<DelegateMsg>\ msg)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Typecast\ the\ base\ pointer\ to\ back\ correct\ derived\ to\ instance}}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ delegateMsg\ =\ std::dynamic\_pointer\_cast<\mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_wait_msg}{DelegateAsyncWaitMsg}}<Args...>>(msg);}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (delegateMsg\ ==\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Invalid\ DelegateMsg\ cast"{}});}
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::lock\_guard<std::mutex>\ lock(delegateMsg-\/>GetLock());}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (delegateMsg-\/>GetInvokerWaiting())}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Invoke\ the\ delegate\ function\ synchronously}}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>SetSync(\textcolor{keyword}{true});}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_void<RetType>::value\ ==\ \textcolor{keyword}{true})}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::apply(\&BaseType::operator(),\ std::tuple\_cat(std::make\_tuple(\textcolor{keyword}{this}),\ delegateMsg-\/>GetArgs()));}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_retVal\ =\ std::apply(\&BaseType::operator(),\ std::tuple\_cat(std::make\_tuple(\textcolor{keyword}{this}),\ delegateMsg-\/>GetArgs()));}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Signal\ the\ source\ thread\ that\ the\ destination\ thread\ function\ call\ is\ complete}}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \ \ \ \ delegateMsg-\/>GetSema().Signal();}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00224\ \ \ \ \ \}}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00227\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_wait_3_01_ret_type_07_args_8_8_8_08_4_aad83ab252e882f069a4e074ba6daff93}{IsSuccess}}()\ \{\ \textcolor{keywordflow}{return}\ m\_success;\ \}}
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00230\ \ \ \ \ RetType\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_free_async_wait_3_01_ret_type_07_args_8_8_8_08_4_a48023eef054e9c8fd98f8356d9357d48}{GetRetVal}}()\ \{\ \textcolor{keywordflow}{return}\ std::any\_cast<RetType>(m\_retVal);\ \}}
\DoxyCodeLine{00231\ }
\DoxyCodeLine{00232\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00233\ \ \ \ \ \textcolor{keywordtype}{bool}\ m\_success\ =\ \textcolor{keyword}{false};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ to\ true\ if\ async\ function\ succeeds}}
\DoxyCodeLine{00234\ \ \ \ \ std::chrono::milliseconds\ m\_timeout;\ \ \ \ \textcolor{comment}{//\ Time\ in\ mS\ to\ wait\ for\ async\ function\ to\ invoke}}
\DoxyCodeLine{00235\ \ \ \ \ std::any\ m\_retVal;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Return\ value\ of\ the\ invoked\ function}}
\DoxyCodeLine{00236\ \ \ \ \ \textcolor{comment}{//\ </common\_code>}}
\DoxyCodeLine{00237\ \};}
\DoxyCodeLine{00238\ }
\DoxyCodeLine{00239\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ C,\ \textcolor{keyword}{class}\ R>}
\DoxyCodeLine{00240\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_async_wait}{DelegateMemberAsyncWait}};\ \textcolor{comment}{//\ Not\ defined}}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00242\ \textcolor{comment}{//\ DelegateMemberAsyncWait\ class\ asynchronously\ block\ invokes\ a\ class\ member\ target\ function.}}
\DoxyCodeLine{00243\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }TClass,\ \textcolor{keyword}{class\ }RetType,\ \textcolor{keyword}{class}...\ Args>}
\DoxyCodeLine{00244\ \textcolor{keyword}{class\ }\mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_async_wait}{DelegateMemberAsyncWait}}<TClass,\ RetType(Args...)>\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_async}{DelegateMemberAsync}}<TClass,\ RetType(Args...)>\ \{}
\DoxyCodeLine{00245\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00246\ \ \ \ \ \textcolor{keyword}{typedef}\ TClass*\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_aaecfde6d367d64edd65e8e5c0fbe394a}{ObjectPtr}};}
\DoxyCodeLine{00247\ \ \ \ \ \textcolor{keyword}{typedef}\ RetType(TClass::*MemberFunc)(Args...);}
\DoxyCodeLine{00248\ \ \ \ \ \textcolor{keyword}{typedef}\ RetType(TClass::*ConstMemberFunc)(Args...)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00249\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\ =\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_async_wait}{DelegateMemberAsyncWait}}<TClass,\ RetType(Args...)>;}
\DoxyCodeLine{00250\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{BaseType}}\ =\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_async}{DelegateMemberAsync}}<TClass,\ RetType(Args...)>;}
\DoxyCodeLine{00251\ }
\DoxyCodeLine{00252\ \ \ \ \ \textcolor{comment}{//\ Contructors\ take\ a\ class\ instance,\ member\ function,\ and\ delegate\ thread}}
\DoxyCodeLine{00253\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_aa5e648273103fbcdc4690f07f4f051a9}{DelegateMemberAsyncWait}}(\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_aaecfde6d367d64edd65e8e5c0fbe394a}{ObjectPtr}}\ \textcolor{keywordtype}{object},\ MemberFunc\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread,\ std::chrono::milliseconds\ timeout)\ :}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{BaseType}}(object,\ func,\ thread),\ m\_timeout(timeout)\ \{}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ Bind(\textcolor{keywordtype}{object},\ func,\ thread);}
\DoxyCodeLine{00256\ \ \ \ \ \}}
\DoxyCodeLine{00257\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a3e831f0389d2ddfa37c5c6a24f145dd4}{DelegateMemberAsyncWait}}(\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_aaecfde6d367d64edd65e8e5c0fbe394a}{ObjectPtr}}\ \textcolor{keywordtype}{object},\ ConstMemberFunc\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread,\ std::chrono::milliseconds\ timeout)\ :}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{BaseType}}(object,\ func,\ thread),\ m\_timeout(timeout)\ \{}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ Bind(\textcolor{keywordtype}{object},\ func,\ thread);}
\DoxyCodeLine{00260\ \ \ \ \ \}}
\DoxyCodeLine{00261\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a0b1ea98a55b2871d5b21c3d85d811baf}{DelegateMemberAsyncWait}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ rhs)\ :}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{BaseType}}(rhs)\ \{}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ Assign(rhs);}
\DoxyCodeLine{00264\ \ \ \ \ \}}
\DoxyCodeLine{00265\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a93fccd873d370ab1c6ce08a8d731a85e}{DelegateMemberAsyncWait}}()\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00268\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a24c3b8b9fd284963b56d32b2aeaf5bd1}{Bind}}(\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_aaecfde6d367d64edd65e8e5c0fbe394a}{ObjectPtr}}\ \textcolor{keywordtype}{object},\ MemberFunc\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread)\ \{}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ BaseType::Bind(\textcolor{keywordtype}{object},\ func,\ thread);}
\DoxyCodeLine{00270\ \ \ \ \ \}}
\DoxyCodeLine{00271\ }
\DoxyCodeLine{00273\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_af52d71df3cdb3d55a49e725b63a19d25}{Bind}}(\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_aaecfde6d367d64edd65e8e5c0fbe394a}{ObjectPtr}}\ \textcolor{keywordtype}{object},\ ConstMemberFunc\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread)\ \{}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ BaseType::Bind(\textcolor{keywordtype}{object},\ func,\ thread);}
\DoxyCodeLine{00275\ \ \ \ \ \}}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \ \ \ \ \textcolor{comment}{//\ <common\_code>}}
\DoxyCodeLine{00278\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a1ead27747d4dc9a932bc7957de036a6c}{Assign}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ rhs)\ \{}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ m\_timeout\ =\ rhs.m\_timeout;}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ BaseType::Assign(rhs);}
\DoxyCodeLine{00281\ \ \ \ \ \}}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}*\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a2f80842f6fce3a49b26fd09d5f0ed283}{Clone}}()\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{00285\ \ \ \ \ \}}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00287\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a6e96e0302225e7c2df7bd2daca5a6d26}{operator=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ rhs)\ \{}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\&rhs\ !=\ \textcolor{keyword}{this})\ \{}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \ \ \ \ BaseType::operator=(rhs);}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \ \ \ \ Assign(rhs);}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00293\ \ \ \ \ \}}
\DoxyCodeLine{00294\ }
\DoxyCodeLine{00295\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_ab9b6a5c6f42ee235c731de9d6df23ece}{operator==}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_base}{DelegateBase}}\&\ rhs)\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ derivedRhs\ =\ \textcolor{keyword}{dynamic\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}*\textcolor{keyword}{>}(\&rhs);}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ derivedRhs\ \&\&}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \ \ m\_timeout\ ==\ derivedRhs-\/>m\_timeout\ \&\&}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \ \ \ \ BaseType::operator==(rhs);}
\DoxyCodeLine{00300\ \ \ \ \ \}}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00302\ \ \ \ \ \textcolor{comment}{//\ Invoke\ delegate\ function\ asynchronously\ and\ block\ for\ function\ return\ value.\ }}
\DoxyCodeLine{00303\ \ \ \ \ \textcolor{comment}{//\ Called\ by\ the\ source\ thread.\ Dispatches\ the\ delegate\ data\ into\ the\ destination\ }}
\DoxyCodeLine{00304\ \ \ \ \ \textcolor{comment}{//\ thread\ message\ queue.\ DelegateInvoke()\ must\ be\ called\ by\ the\ destination\ thread\ }}
\DoxyCodeLine{00305\ \ \ \ \ \textcolor{comment}{//\ to\ invoke\ the\ target\ function.}}
\DoxyCodeLine{00306\ \ \ \ \ \textcolor{keyword}{virtual}\ RetType\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a3cb42151d01cc03b45f2248fc513d847}{operator()}}(Args...\ args)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>GetSync())}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ BaseType::operator()(args...);}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ a\ clone\ instance\ of\ this\ delegate\ }}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ delegate\ =\ std::shared\_ptr<ClassType>(Clone());}
\DoxyCodeLine{00313\ }
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ a\ new\ message\ instance\ }}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ msg\ =\ std::make\_shared<\mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_wait_msg}{DelegateAsyncWaitMsg}}<Args...>>(delegate,\ args...);}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \ \ \ \ msg-\/>\mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_wait_msg_a9a8287c553329db52f3710863a318023}{SetInvokerWaiting}}(\textcolor{keyword}{true});}
\DoxyCodeLine{00317\ }
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Dispatch\ message\ onto\ the\ callback\ destination\ thread.\ DelegateInvoke()}}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ will\ be\ called\ by\ the\ destination\ thread.\ }}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>GetThread().DispatchDelegate(msg);}
\DoxyCodeLine{00321\ }
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Wait\ for\ destination\ thread\ to\ execute\ the\ delegate\ function\ and\ get\ return\ value}}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((m\_success\ =\ msg-\/>GetSema().Wait(m\_timeout)))}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_retVal\ =\ delegate-\/>m\_retVal;}
\DoxyCodeLine{00325\ }
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Protect\ data\ shared\ between\ source\ and\ destination\ threads}}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::lock\_guard<std::mutex>\ lock(msg-\/>GetLock());}
\DoxyCodeLine{00328\ }
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ flag\ that\ source\ is\ not\ waiting\ anymore}}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ msg-\/>SetInvokerWaiting(\textcolor{keyword}{false});}
\DoxyCodeLine{00331\ }
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Return\ the\ destintation\ thread\ return\ value,\ if\ any}}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_void<RetType>::value\ ==\ \textcolor{keyword}{false})}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_retVal.has\_value())}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::any\_cast<RetType>(m\_retVal);}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ RetType();}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00341\ \ \ \ \ \}}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00343\ \ \ \ \ \textcolor{comment}{//\ Invoke\ delegate\ function\ asynchronously\ and\ block\ for\ function\ return\ value.}}
\DoxyCodeLine{00344\ \ \ \ \ \textcolor{comment}{//\ Called\ by\ the\ source\ thread.}}
\DoxyCodeLine{00345\ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a8291fb2c29ace6e80959768d7e614e13}{AsyncInvoke}}(Args...\ args)\ \{}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_void<RetType>::value\ ==\ \textcolor{keyword}{true})}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ \ \ \ \ operator()(args...);}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ IsSuccess()\ ?\ std::optional<bool>(\textcolor{keyword}{true})\ :\ std::optional<bool>();}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ retVal\ =\ operator()(args...);}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ IsSuccess()\ ?\ std::optional<RetType>(retVal)\ :\ std::optional<RetType>();}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00356\ \ \ \ \ \}}
\DoxyCodeLine{00357\ }
\DoxyCodeLine{00358\ \ \ \ \ \textcolor{comment}{//\ Invoke\ the\ delegate\ function\ on\ the\ destination\ thread.\ Each\ source\ thread\ call}}
\DoxyCodeLine{00359\ \ \ \ \ \textcolor{comment}{//\ to\ operator()\ generate\ a\ call\ to\ DelegateInvoke()\ on\ the\ destination\ thread.\ A\ }}
\DoxyCodeLine{00360\ \ \ \ \ \textcolor{comment}{//\ lock\ provides\ thread\ safety\ between\ source\ and\ destination\ delegateMsg\ thread\ access.}}
\DoxyCodeLine{00361\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a20e9f7755ba4b19fb12988da5f8fe6f7}{DelegateInvoke}}(std::shared\_ptr<DelegateMsg>\ msg)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Typecast\ the\ base\ pointer\ to\ back\ correct\ derived\ to\ instance}}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ delegateMsg\ =\ std::dynamic\_pointer\_cast<\mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_wait_msg}{DelegateAsyncWaitMsg}}<Args...>>(msg);}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (delegateMsg\ ==\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Invalid\ DelegateMsg\ cast"{}});}
\DoxyCodeLine{00366\ }
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::lock\_guard<std::mutex>\ lock(delegateMsg-\/>GetLock());}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (delegateMsg-\/>GetInvokerWaiting())}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Invoke\ the\ delegate\ function\ synchronously}}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>SetSync(\textcolor{keyword}{true});}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_void<RetType>::value\ ==\ \textcolor{keyword}{true})}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::apply(\&BaseType::operator(),\ std::tuple\_cat(std::make\_tuple(\textcolor{keyword}{this}),\ delegateMsg-\/>GetArgs()));}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_retVal\ =\ std::apply(\&BaseType::operator(),\ std::tuple\_cat(std::make\_tuple(\textcolor{keyword}{this}),\ delegateMsg-\/>GetArgs()));}
\DoxyCodeLine{00376\ }
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Signal\ the\ source\ thread\ that\ the\ destination\ thread\ function\ call\ is\ complete}}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ delegateMsg-\/>GetSema().Signal();}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00380\ \ \ \ \ \}}
\DoxyCodeLine{00381\ }
\DoxyCodeLine{00383\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_ad01b5e6aefd4680239c0965aa3d47cbd}{IsSuccess}}()\ \{\ \textcolor{keywordflow}{return}\ m\_success;\ \}}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00386\ \ \ \ \ RetType\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_adab84e35075979f20bb2bd5e1bc6dcec}{GetRetVal}}()\ \{\ \textcolor{keywordflow}{return}\ std::any\_cast<RetType>(m\_retVal);\ \}}
\DoxyCodeLine{00387\ }
\DoxyCodeLine{00388\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00389\ \ \ \ \ \textcolor{keywordtype}{bool}\ m\_success\ =\ \textcolor{keyword}{false};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ to\ true\ if\ async\ function\ succeeds}}
\DoxyCodeLine{00390\ \ \ \ \ std::chrono::milliseconds\ m\_timeout;\ \ \ \ \textcolor{comment}{//\ Time\ in\ mS\ to\ wait\ for\ async\ function\ to\ invoke}}
\DoxyCodeLine{00391\ \ \ \ \ std::any\ m\_retVal;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Return\ value\ of\ the\ invoked\ function}}
\DoxyCodeLine{00392\ \ \ \ \ \textcolor{comment}{//\ </common\_code>}}
\DoxyCodeLine{00393\ \};}
\DoxyCodeLine{00394\ }
\DoxyCodeLine{00395\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ C,\ \textcolor{keyword}{class}\ R>}
\DoxyCodeLine{00396\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_sp_async_wait}{DelegateMemberSpAsyncWait}};\ \textcolor{comment}{//\ Not\ defined}}
\DoxyCodeLine{00397\ }
\DoxyCodeLine{00398\ \textcolor{comment}{//\ DelegateMemberSpAsyncWait\ class\ asynchronously\ block\ invokes\ a\ std::shared\_ptr\ target\ function.}}
\DoxyCodeLine{00399\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }TClass,\ \textcolor{keyword}{class\ }RetType,\ \textcolor{keyword}{class}...\ Args>}
\DoxyCodeLine{00400\ \textcolor{keyword}{class\ }\mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_sp_async_wait}{DelegateMemberSpAsyncWait}}<TClass,\ RetType(Args...)>\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_sp_async}{DelegateMemberSpAsync}}<TClass,\ RetType(Args...)>\ \{}
\DoxyCodeLine{00401\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00402\ \ \ \ \ \textcolor{keyword}{typedef}\ std::shared\_ptr<TClass>\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a48f5e788dd4b24f822155f2c825ae4eb}{ObjectPtr}};}
\DoxyCodeLine{00403\ \ \ \ \ \textcolor{keyword}{typedef}\ RetType(TClass::*\ MemberFunc)(Args...);}
\DoxyCodeLine{00404\ \ \ \ \ \textcolor{keyword}{typedef}\ RetType(TClass::*\ ConstMemberFunc)(Args...)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00405\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\ =\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_sp_async_wait}{DelegateMemberSpAsyncWait}}<TClass,\ RetType(Args...)>;}
\DoxyCodeLine{00406\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{BaseType}}\ =\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_sp_async}{DelegateMemberSpAsync}}<TClass,\ RetType(Args...)>;}
\DoxyCodeLine{00407\ }
\DoxyCodeLine{00408\ \ \ \ \ \textcolor{comment}{//\ Contructors\ take\ a\ class\ instance,\ member\ function,\ and\ delegate\ thread}}
\DoxyCodeLine{00409\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a75167ccb570cc43c7262e30039f94965}{DelegateMemberSpAsyncWait}}(\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a48f5e788dd4b24f822155f2c825ae4eb}{ObjectPtr}}\ \textcolor{keywordtype}{object},\ MemberFunc\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread,\ std::chrono::milliseconds\ timeout)\ :}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{BaseType}}(object,\ func,\ thread),\ m\_timeout(timeout)\ \{}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \ \ Bind(\textcolor{keywordtype}{object},\ func,\ thread);}
\DoxyCodeLine{00412\ \ \ \ \ \}}
\DoxyCodeLine{00413\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a8b5495da7bbed3d691b5b7881c495018}{DelegateMemberSpAsyncWait}}(\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a48f5e788dd4b24f822155f2c825ae4eb}{ObjectPtr}}\ \textcolor{keywordtype}{object},\ ConstMemberFunc\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread,\ std::chrono::milliseconds\ timeout)\ :}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{BaseType}}(object,\ func,\ thread),\ m\_timeout(timeout)\ \{}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ Bind(\textcolor{keywordtype}{object},\ func,\ thread);}
\DoxyCodeLine{00416\ \ \ \ \ \}}
\DoxyCodeLine{00417\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a6e64aa7476c1cc451d8ac21f660953a8}{DelegateMemberSpAsyncWait}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ rhs)\ :}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{BaseType}}(rhs)\ \{}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ Assign(rhs);}
\DoxyCodeLine{00420\ \ \ \ \ \}}
\DoxyCodeLine{00421\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_aad11185618821cd2a0cfa68dc2af1e25}{DelegateMemberSpAsyncWait}}()\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00422\ }
\DoxyCodeLine{00424\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_aa513bda0b439e89c7c4149a56bc10a10}{Bind}}(\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a48f5e788dd4b24f822155f2c825ae4eb}{ObjectPtr}}\ \textcolor{keywordtype}{object},\ MemberFunc\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread)\ \{}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ BaseType::Bind(\textcolor{keywordtype}{object},\ func,\ thread);}
\DoxyCodeLine{00426\ \ \ \ \ \}}
\DoxyCodeLine{00427\ }
\DoxyCodeLine{00429\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a5e7bbce4e16c5045380edf7003f0493d}{Bind}}(\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a48f5e788dd4b24f822155f2c825ae4eb}{ObjectPtr}}\ \textcolor{keywordtype}{object},\ ConstMemberFunc\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread)\ \{}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ BaseType::Bind(\textcolor{keywordtype}{object},\ func,\ thread);}
\DoxyCodeLine{00431\ \ \ \ \ \}}
\DoxyCodeLine{00432\ }
\DoxyCodeLine{00433\ \ \ \ \ \textcolor{comment}{//\ <common\_code>}}
\DoxyCodeLine{00434\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a248c7fbf1212c7debba5c30e8a84fa80}{Assign}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ rhs)\ \{}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ m\_timeout\ =\ rhs.m\_timeout;}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ BaseType::Assign(rhs);}
\DoxyCodeLine{00437\ \ \ \ \ \}}
\DoxyCodeLine{00438\ }
\DoxyCodeLine{00439\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}*\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_ac1e27a71399c2444f302bfec7c21ae44}{Clone}}()\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{00441\ \ \ \ \ \}}
\DoxyCodeLine{00442\ }
\DoxyCodeLine{00443\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a6d24d274b5686a6cfda2255f2c6049de}{operator=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ rhs)\ \{}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\&rhs\ !=\ \textcolor{keyword}{this})\ \{}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ \ \ \ \ BaseType::operator=(rhs);}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \ \ \ \ \ \ Assign(rhs);}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00449\ \ \ \ \ \}}
\DoxyCodeLine{00450\ }
\DoxyCodeLine{00451\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_aafbb90f4eb5ec2fcc05456fe139a6cee}{operator==}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_base}{DelegateBase}}\&\ rhs)\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ derivedRhs\ =\ \textcolor{keyword}{dynamic\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4}{ClassType}}*\textcolor{keyword}{>}(\&rhs);}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ derivedRhs\ \&\&}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \ \ \ \ m\_timeout\ ==\ derivedRhs-\/>m\_timeout\ \&\&}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ \ \ \ \ BaseType::operator==(rhs);}
\DoxyCodeLine{00456\ \ \ \ \ \}}
\DoxyCodeLine{00457\ }
\DoxyCodeLine{00458\ \ \ \ \ \textcolor{comment}{//\ Invoke\ delegate\ function\ asynchronously\ and\ block\ for\ function\ return\ value.\ }}
\DoxyCodeLine{00459\ \ \ \ \ \textcolor{comment}{//\ Called\ by\ the\ source\ thread.\ Dispatches\ the\ delegate\ data\ into\ the\ destination\ }}
\DoxyCodeLine{00460\ \ \ \ \ \textcolor{comment}{//\ thread\ message\ queue.\ DelegateInvoke()\ must\ be\ called\ by\ the\ destination\ thread\ }}
\DoxyCodeLine{00461\ \ \ \ \ \textcolor{comment}{//\ to\ invoke\ the\ target\ function.}}
\DoxyCodeLine{00462\ \ \ \ \ \textcolor{keyword}{virtual}\ RetType\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_aedbf462168487ee92af82d8a672f3cbc}{operator()}}(Args...\ args)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>GetSync())}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ BaseType::operator()(args...);}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ a\ clone\ instance\ of\ this\ delegate\ }}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ delegate\ =\ std::shared\_ptr<ClassType>(Clone());}
\DoxyCodeLine{00469\ }
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ a\ new\ message\ instance\ }}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ msg\ =\ std::make\_shared<\mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_wait_msg}{DelegateAsyncWaitMsg}}<Args...>>(delegate,\ args...);}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \ \ \ \ msg-\/>\mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_wait_msg_a9a8287c553329db52f3710863a318023}{SetInvokerWaiting}}(\textcolor{keyword}{true});}
\DoxyCodeLine{00473\ }
\DoxyCodeLine{00474\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Dispatch\ message\ onto\ the\ callback\ destination\ thread.\ DelegateInvoke()}}
\DoxyCodeLine{00475\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ will\ be\ called\ by\ the\ destination\ thread.\ }}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>GetThread().DispatchDelegate(msg);}
\DoxyCodeLine{00477\ }
\DoxyCodeLine{00478\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Wait\ for\ destination\ thread\ to\ execute\ the\ delegate\ function\ and\ get\ return\ value}}
\DoxyCodeLine{00479\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((m\_success\ =\ msg-\/>GetSema().Wait(m\_timeout)))}
\DoxyCodeLine{00480\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_retVal\ =\ delegate-\/>m\_retVal;}
\DoxyCodeLine{00481\ }
\DoxyCodeLine{00482\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Protect\ data\ shared\ between\ source\ and\ destination\ threads}}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::lock\_guard<std::mutex>\ lock(msg-\/>GetLock());}
\DoxyCodeLine{00484\ }
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ flag\ that\ source\ is\ not\ waiting\ anymore}}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ \ \ \ \ msg-\/>SetInvokerWaiting(\textcolor{keyword}{false});}
\DoxyCodeLine{00487\ }
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Return\ the\ destintation\ thread\ return\ value,\ if\ any}}
\DoxyCodeLine{00489\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_void<RetType>::value\ ==\ \textcolor{keyword}{false})}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00491\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_retVal.has\_value())}
\DoxyCodeLine{00492\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::any\_cast<RetType>(m\_retVal);}
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ RetType();}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00497\ \ \ \ \ \}}
\DoxyCodeLine{00498\ }
\DoxyCodeLine{00499\ \ \ \ \ \textcolor{comment}{//\ Invoke\ delegate\ function\ asynchronously\ and\ block\ for\ function\ return\ value.}}
\DoxyCodeLine{00500\ \ \ \ \ \textcolor{comment}{//\ Called\ by\ the\ source\ thread.}}
\DoxyCodeLine{00501\ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a5f4fd75f158b4553776e2d62f31cd326}{AsyncInvoke}}(Args...\ args)\ \{}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_void<RetType>::value\ ==\ \textcolor{keyword}{true})}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ \ \ \ \ operator()(args...);}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ IsSuccess()\ ?\ std::optional<bool>(\textcolor{keyword}{true})\ :\ std::optional<bool>();}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ retVal\ =\ operator()(args...);}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ IsSuccess()\ ?\ std::optional<RetType>(retVal)\ :\ std::optional<RetType>();}
\DoxyCodeLine{00511\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00512\ \ \ \ \ \}}
\DoxyCodeLine{00513\ }
\DoxyCodeLine{00514\ \ \ \ \ \textcolor{comment}{//\ Invoke\ the\ delegate\ function\ on\ the\ destination\ thread.\ Each\ source\ thread\ call}}
\DoxyCodeLine{00515\ \ \ \ \ \textcolor{comment}{//\ to\ operator()\ generate\ a\ call\ to\ DelegateInvoke()\ on\ the\ destination\ thread.\ A\ }}
\DoxyCodeLine{00516\ \ \ \ \ \textcolor{comment}{//\ lock\ provides\ thread\ safety\ between\ source\ and\ destination\ delegateMsg\ thread\ access.}}
\DoxyCodeLine{00517\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_a89a54b3aa7333005761c42b4335d728a}{DelegateInvoke}}(std::shared\_ptr<DelegateMsg>\ msg)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Typecast\ the\ base\ pointer\ to\ back\ correct\ derived\ to\ instance}}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ delegateMsg\ =\ std::dynamic\_pointer\_cast<\mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_wait_msg}{DelegateAsyncWaitMsg}}<Args...>>(msg);}
\DoxyCodeLine{00520\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (delegateMsg\ ==\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00521\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Invalid\ DelegateMsg\ cast"{}});}
\DoxyCodeLine{00522\ }
\DoxyCodeLine{00523\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::lock\_guard<std::mutex>\ lock(delegateMsg-\/>GetLock());}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (delegateMsg-\/>GetInvokerWaiting())}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00526\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Invoke\ the\ delegate\ function\ synchronously}}
\DoxyCodeLine{00527\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>SetSync(\textcolor{keyword}{true});}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_void<RetType>::value\ ==\ \textcolor{keyword}{true})}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::apply(\&BaseType::operator(),\ std::tuple\_cat(std::make\_tuple(\textcolor{keyword}{this}),\ delegateMsg-\/>GetArgs()));}
\DoxyCodeLine{00530\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00531\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_retVal\ =\ std::apply(\&BaseType::operator(),\ std::tuple\_cat(std::make\_tuple(\textcolor{keyword}{this}),\ delegateMsg-\/>GetArgs()));}
\DoxyCodeLine{00532\ }
\DoxyCodeLine{00533\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Signal\ the\ source\ thread\ that\ the\ destination\ thread\ function\ call\ is\ complete}}
\DoxyCodeLine{00534\ \ \ \ \ \ \ \ \ \ \ \ \ delegateMsg-\/>GetSema().Signal();}
\DoxyCodeLine{00535\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00536\ \ \ \ \ \}}
\DoxyCodeLine{00537\ }
\DoxyCodeLine{00539\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_ae80f96b3fcb4fb14fd0ef9ba916cf25c}{IsSuccess}}()\ \{\ \textcolor{keywordflow}{return}\ m\_success;\ \}}
\DoxyCodeLine{00540\ }
\DoxyCodeLine{00542\ \ \ \ \ RetType\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_member_sp_async_wait_3_01_t_class_00_01_ret_type_07_args_8_8_8_08_4_aeee90b3872f904459d05eef068b45504}{GetRetVal}}()\ \{\ \textcolor{keywordflow}{return}\ std::any\_cast<RetType>(m\_retVal);\ \}}
\DoxyCodeLine{00543\ }
\DoxyCodeLine{00544\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00545\ \ \ \ \ \textcolor{keywordtype}{bool}\ m\_success\ =\ \textcolor{keyword}{false};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ to\ true\ if\ async\ function\ succeeds}}
\DoxyCodeLine{00546\ \ \ \ \ std::chrono::milliseconds\ m\_timeout;\ \ \ \ \textcolor{comment}{//\ Time\ in\ mS\ to\ wait\ for\ async\ function\ to\ invoke}}
\DoxyCodeLine{00547\ \ \ \ \ std::any\ m\_retVal;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Return\ value\ of\ the\ invoked\ function}}
\DoxyCodeLine{00548\ \ \ \ \ \textcolor{comment}{//\ </common\_code>}}
\DoxyCodeLine{00549\ \};}
\DoxyCodeLine{00550\ }
\DoxyCodeLine{00551\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ R>}
\DoxyCodeLine{00552\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_delegate_lib_1_1_delegate_function_async_wait}{DelegateFunctionAsyncWait}};\ \textcolor{comment}{//\ Not\ defined}}
\DoxyCodeLine{00553\ }
\DoxyCodeLine{00554\ \textcolor{comment}{//\ DelegateFunctionAsync\ class\ asynchronously\ block\ invokes\ a\ std::function\ target\ function.}}
\DoxyCodeLine{00555\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }RetType,\ \textcolor{keyword}{class}...\ Args>}
\DoxyCodeLine{00556\ \textcolor{keyword}{class\ }\mbox{\hyperlink{struct_delegate_lib_1_1_delegate_function_async_wait}{DelegateFunctionAsyncWait}}<RetType(Args...)>\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_function_async}{DelegateFunctionAsync}}<RetType(Args...)>\ \{}
\DoxyCodeLine{00557\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00558\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_wait_3_01_ret_type_07_args_8_8_8_08_4_a793983b42fc5819a186a891b9cac5806}{FunctionType}}\ =\ std::function<RetType(Args...)>;}
\DoxyCodeLine{00559\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_wait_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\ =\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_function_async_wait}{DelegateFunctionAsyncWait}}<RetType(Args...)>;}
\DoxyCodeLine{00560\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4}{BaseType}}\ =\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_function_async}{DelegateFunctionAsync}}<RetType(Args...)>;}
\DoxyCodeLine{00561\ }
\DoxyCodeLine{00562\ \ \ \ \ \textcolor{comment}{//\ Contructors\ take\ a\ std::function,\ delegate\ thread\ and\ timeout}}
\DoxyCodeLine{00563\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_wait_3_01_ret_type_07_args_8_8_8_08_4_a6843df2bb2187538a52295ef40915162}{DelegateFunctionAsyncWait}}(\mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_wait_3_01_ret_type_07_args_8_8_8_08_4_a793983b42fc5819a186a891b9cac5806}{FunctionType}}\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread,\ std::chrono::milliseconds\ timeout)\ :}
\DoxyCodeLine{00564\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4}{BaseType}}(func,\ thread),\ m\_timeout(timeout)\ \{}
\DoxyCodeLine{00565\ \ \ \ \ \ \ \ \ Bind(func,\ thread);}
\DoxyCodeLine{00566\ \ \ \ \ \}}
\DoxyCodeLine{00567\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_wait_3_01_ret_type_07_args_8_8_8_08_4_a49ee2d06133beb8f1f97d9435dd233d8}{DelegateFunctionAsyncWait}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_wait_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ rhs)\ :}
\DoxyCodeLine{00568\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_3_01_ret_type_07_args_8_8_8_08_4}{BaseType}}(rhs)\ \{}
\DoxyCodeLine{00569\ \ \ \ \ \ \ \ \ Assign(rhs);}
\DoxyCodeLine{00570\ \ \ \ \ \}}
\DoxyCodeLine{00571\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_wait_3_01_ret_type_07_args_8_8_8_08_4_afae9b073f590b47117d0ee00e100b7e2}{DelegateFunctionAsyncWait}}()\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00572\ }
\DoxyCodeLine{00574\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_wait_3_01_ret_type_07_args_8_8_8_08_4_a56245374ac83ac8ae2cb5ea0de8907f8}{Bind}}(\mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_wait_3_01_ret_type_07_args_8_8_8_08_4_a793983b42fc5819a186a891b9cac5806}{FunctionType}}\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread)\ \{}
\DoxyCodeLine{00575\ \ \ \ \ \ \ \ \ BaseType::Bind(func,\ thread);}
\DoxyCodeLine{00576\ \ \ \ \ \}}
\DoxyCodeLine{00577\ }
\DoxyCodeLine{00578\ \ \ \ \ \textcolor{comment}{//\ <common\_code>}}
\DoxyCodeLine{00579\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_wait_3_01_ret_type_07_args_8_8_8_08_4_a06a1f3a07b3b85f30d1d149a8ce7694d}{Assign}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_wait_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ rhs)\ \{}
\DoxyCodeLine{00580\ \ \ \ \ \ \ \ \ m\_timeout\ =\ rhs.m\_timeout;}
\DoxyCodeLine{00581\ \ \ \ \ \ \ \ \ BaseType::Assign(rhs);}
\DoxyCodeLine{00582\ \ \ \ \ \}}
\DoxyCodeLine{00583\ }
\DoxyCodeLine{00584\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_wait_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}*\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_wait_3_01_ret_type_07_args_8_8_8_08_4_a06308fd077f75299814b78d042e52ac0}{Clone}}()\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_wait_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{00586\ \ \ \ \ \}}
\DoxyCodeLine{00587\ }
\DoxyCodeLine{00588\ \ \ \ \ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_wait_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_wait_3_01_ret_type_07_args_8_8_8_08_4_a6c3628f557fdff90db3bf3f7df4f28f1}{operator=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_wait_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}\&\ rhs)\ \{}
\DoxyCodeLine{00589\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\&rhs\ !=\ \textcolor{keyword}{this})\ \{}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \ \ \ \ \ \ BaseType::operator=(rhs);}
\DoxyCodeLine{00591\ \ \ \ \ \ \ \ \ \ \ \ \ Assign(rhs);}
\DoxyCodeLine{00592\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00593\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00594\ \ \ \ \ \}}
\DoxyCodeLine{00595\ }
\DoxyCodeLine{00596\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_wait_3_01_ret_type_07_args_8_8_8_08_4_a0cc272f27fb57a62d2c762f74f032eb2}{operator==}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_base}{DelegateBase}}\&\ rhs)\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{00597\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ derivedRhs\ =\ \textcolor{keyword}{dynamic\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_wait_3_01_ret_type_07_args_8_8_8_08_4}{ClassType}}*\textcolor{keyword}{>}(\&rhs);}
\DoxyCodeLine{00598\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ derivedRhs\ \&\&}
\DoxyCodeLine{00599\ \ \ \ \ \ \ \ \ \ \ \ \ m\_timeout\ ==\ derivedRhs-\/>m\_timeout\ \&\&}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ \ \ \ \ BaseType::operator==(rhs);}
\DoxyCodeLine{00601\ \ \ \ \ \}}
\DoxyCodeLine{00602\ }
\DoxyCodeLine{00603\ \ \ \ \ \textcolor{comment}{//\ Invoke\ delegate\ function\ asynchronously\ and\ block\ for\ function\ return\ value.\ }}
\DoxyCodeLine{00604\ \ \ \ \ \textcolor{comment}{//\ Called\ by\ the\ source\ thread.\ Dispatches\ the\ delegate\ data\ into\ the\ destination\ }}
\DoxyCodeLine{00605\ \ \ \ \ \textcolor{comment}{//\ thread\ message\ queue.\ DelegateInvoke()\ must\ be\ called\ by\ the\ destination\ thread\ }}
\DoxyCodeLine{00606\ \ \ \ \ \textcolor{comment}{//\ to\ invoke\ the\ target\ function.}}
\DoxyCodeLine{00607\ \ \ \ \ \textcolor{keyword}{virtual}\ RetType\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_wait_3_01_ret_type_07_args_8_8_8_08_4_abe10c60e4a83a5611e0b9bc9ed6e05e1}{operator()}}(Args...\ args)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00608\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>GetSync())}
\DoxyCodeLine{00609\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ BaseType::operator()(args...);}
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00611\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00612\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ a\ clone\ instance\ of\ this\ delegate\ }}
\DoxyCodeLine{00613\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ delegate\ =\ std::shared\_ptr<ClassType>(Clone());}
\DoxyCodeLine{00614\ }
\DoxyCodeLine{00615\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ a\ new\ message\ instance\ }}
\DoxyCodeLine{00616\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ msg\ =\ std::make\_shared<\mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_wait_msg}{DelegateAsyncWaitMsg}}<Args...>>(delegate,\ args...);}
\DoxyCodeLine{00617\ \ \ \ \ \ \ \ \ \ \ \ \ msg-\/>\mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_wait_msg_a9a8287c553329db52f3710863a318023}{SetInvokerWaiting}}(\textcolor{keyword}{true});}
\DoxyCodeLine{00618\ }
\DoxyCodeLine{00619\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Dispatch\ message\ onto\ the\ callback\ destination\ thread.\ DelegateInvoke()}}
\DoxyCodeLine{00620\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ will\ be\ called\ by\ the\ destination\ thread.\ }}
\DoxyCodeLine{00621\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>GetThread().DispatchDelegate(msg);}
\DoxyCodeLine{00622\ }
\DoxyCodeLine{00623\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Wait\ for\ destination\ thread\ to\ execute\ the\ delegate\ function\ and\ get\ return\ value}}
\DoxyCodeLine{00624\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((m\_success\ =\ msg-\/>GetSema().Wait(m\_timeout)))}
\DoxyCodeLine{00625\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_retVal\ =\ delegate-\/>m\_retVal;}
\DoxyCodeLine{00626\ }
\DoxyCodeLine{00627\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Protect\ data\ shared\ between\ source\ and\ destination\ threads}}
\DoxyCodeLine{00628\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::lock\_guard<std::mutex>\ lock(msg-\/>GetLock());}
\DoxyCodeLine{00629\ }
\DoxyCodeLine{00630\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ flag\ that\ source\ is\ not\ waiting\ anymore}}
\DoxyCodeLine{00631\ \ \ \ \ \ \ \ \ \ \ \ \ msg-\/>SetInvokerWaiting(\textcolor{keyword}{false});}
\DoxyCodeLine{00632\ }
\DoxyCodeLine{00633\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Return\ the\ destintation\ thread\ return\ value,\ if\ any}}
\DoxyCodeLine{00634\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_void<RetType>::value\ ==\ \textcolor{keyword}{false})}
\DoxyCodeLine{00635\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00636\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_retVal.has\_value())}
\DoxyCodeLine{00637\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::any\_cast<RetType>(m\_retVal);}
\DoxyCodeLine{00638\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00639\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ RetType();}
\DoxyCodeLine{00640\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00641\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00642\ \ \ \ \ \}}
\DoxyCodeLine{00643\ }
\DoxyCodeLine{00644\ \ \ \ \ \textcolor{comment}{//\ Invoke\ delegate\ function\ asynchronously\ and\ block\ for\ function\ return\ value.}}
\DoxyCodeLine{00645\ \ \ \ \ \textcolor{comment}{//\ Called\ by\ the\ source\ thread.}}
\DoxyCodeLine{00646\ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_wait_3_01_ret_type_07_args_8_8_8_08_4_a1c4342829881ac285f0d839906c9f930}{AsyncInvoke}}(Args...\ args)\ \{}
\DoxyCodeLine{00647\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_void<RetType>::value\ ==\ \textcolor{keyword}{true})}
\DoxyCodeLine{00648\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ \ \ \ \ operator()(args...);}
\DoxyCodeLine{00650\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ IsSuccess()\ ?\ std::optional<bool>(\textcolor{keyword}{true})\ :\ std::optional<bool>();}
\DoxyCodeLine{00651\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00653\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00654\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ retVal\ =\ operator()(args...);}
\DoxyCodeLine{00655\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ IsSuccess()\ ?\ std::optional<RetType>(retVal)\ :\ std::optional<RetType>();}
\DoxyCodeLine{00656\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00657\ \ \ \ \ \}}
\DoxyCodeLine{00658\ }
\DoxyCodeLine{00659\ \ \ \ \ \textcolor{comment}{//\ Invoke\ the\ delegate\ function\ on\ the\ destination\ thread.\ Each\ source\ thread\ call}}
\DoxyCodeLine{00660\ \ \ \ \ \textcolor{comment}{//\ to\ operator()\ generate\ a\ call\ to\ DelegateInvoke()\ on\ the\ destination\ thread.\ A\ }}
\DoxyCodeLine{00661\ \ \ \ \ \textcolor{comment}{//\ lock\ provides\ thread\ safety\ between\ source\ and\ destination\ delegateMsg\ thread\ access.}}
\DoxyCodeLine{00662\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_wait_3_01_ret_type_07_args_8_8_8_08_4_a8a0cfe8f1e6f7bc06c161a1f210c6aa7}{DelegateInvoke}}(std::shared\_ptr<DelegateMsg>\ msg)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00663\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Typecast\ the\ base\ pointer\ to\ back\ correct\ derived\ to\ instance}}
\DoxyCodeLine{00664\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ delegateMsg\ =\ std::dynamic\_pointer\_cast<\mbox{\hyperlink{class_delegate_lib_1_1_delegate_async_wait_msg}{DelegateAsyncWaitMsg}}<Args...>>(msg);}
\DoxyCodeLine{00665\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (delegateMsg\ ==\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00666\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Invalid\ DelegateMsg\ cast"{}});}
\DoxyCodeLine{00667\ }
\DoxyCodeLine{00668\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::lock\_guard<std::mutex>\ lock(delegateMsg-\/>GetLock());}
\DoxyCodeLine{00669\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (delegateMsg-\/>GetInvokerWaiting())}
\DoxyCodeLine{00670\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00671\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Invoke\ the\ delegate\ function\ synchronously}}
\DoxyCodeLine{00672\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>SetSync(\textcolor{keyword}{true});}
\DoxyCodeLine{00673\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_void<RetType>::value\ ==\ \textcolor{keyword}{true})}
\DoxyCodeLine{00674\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::apply(\&BaseType::operator(),\ std::tuple\_cat(std::make\_tuple(\textcolor{keyword}{this}),\ delegateMsg-\/>GetArgs()));}
\DoxyCodeLine{00675\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00676\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_retVal\ =\ std::apply(\&BaseType::operator(),\ std::tuple\_cat(std::make\_tuple(\textcolor{keyword}{this}),\ delegateMsg-\/>GetArgs()));}
\DoxyCodeLine{00677\ }
\DoxyCodeLine{00678\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Signal\ the\ source\ thread\ that\ the\ destination\ thread\ function\ call\ is\ complete}}
\DoxyCodeLine{00679\ \ \ \ \ \ \ \ \ \ \ \ \ delegateMsg-\/>GetSema().Signal();}
\DoxyCodeLine{00680\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00681\ \ \ \ \ \}}
\DoxyCodeLine{00682\ }
\DoxyCodeLine{00684\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_wait_3_01_ret_type_07_args_8_8_8_08_4_a0db46ee0537e487e0ffa3daccf2b37aa}{IsSuccess}}()\ \{\ \textcolor{keywordflow}{return}\ m\_success;\ \}}
\DoxyCodeLine{00685\ }
\DoxyCodeLine{00687\ \ \ \ \ RetType\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_function_async_wait_3_01_ret_type_07_args_8_8_8_08_4_a7447f8bc35d5f0749273a90fdbca9376}{GetRetVal}}()\ \{\ \textcolor{keywordflow}{return}\ std::any\_cast<RetType>(m\_retVal);\ \}}
\DoxyCodeLine{00688\ }
\DoxyCodeLine{00689\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00690\ \ \ \ \ \textcolor{keywordtype}{bool}\ m\_success\ =\ \textcolor{keyword}{false};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ to\ true\ if\ async\ function\ succeeds}}
\DoxyCodeLine{00691\ \ \ \ \ std::chrono::milliseconds\ m\_timeout;\ \ \ \ \textcolor{comment}{//\ Time\ in\ mS\ to\ wait\ for\ async\ function\ to\ invoke}}
\DoxyCodeLine{00692\ \ \ \ \ std::any\ m\_retVal;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Return\ value\ of\ the\ invoked\ function}}
\DoxyCodeLine{00693\ \ \ \ \ \textcolor{comment}{//\ </common\_code>}}
\DoxyCodeLine{00694\ \};}
\DoxyCodeLine{00695\ }
\DoxyCodeLine{00696\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }RetType,\ \textcolor{keyword}{class}...\ Args>}
\DoxyCodeLine{00697\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_free_async_wait}{DelegateFreeAsyncWait}}<RetType(Args...)>\ \mbox{\hyperlink{namespace_delegate_lib_a75ff1e13f1cb691402002bfccaf9d1b2}{MakeDelegate}}(RetType(*func)(Args...\ args),\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread,\ std::chrono::milliseconds\ timeout)\ \{}
\DoxyCodeLine{00698\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_free_async_wait}{DelegateFreeAsyncWait}}<RetType(Args...)>(func,\ thread,\ timeout);}
\DoxyCodeLine{00699\ \}}
\DoxyCodeLine{00700\ }
\DoxyCodeLine{00701\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }TClass,\ \textcolor{keyword}{class\ }RetType,\ \textcolor{keyword}{class}...\ Args>}
\DoxyCodeLine{00702\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_async_wait}{DelegateMemberAsyncWait}}<TClass,\ RetType(Args...)>\ \mbox{\hyperlink{namespace_delegate_lib_a75ff1e13f1cb691402002bfccaf9d1b2}{MakeDelegate}}(TClass*\ \textcolor{keywordtype}{object},\ RetType(TClass::*func)(Args...\ args),\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread,\ std::chrono::milliseconds\ timeout)\ \{}
\DoxyCodeLine{00703\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_async_wait}{DelegateMemberAsyncWait}}<TClass,\ RetType(Args...)>(object,\ func,\ thread,\ timeout);}
\DoxyCodeLine{00704\ \}}
\DoxyCodeLine{00705\ }
\DoxyCodeLine{00706\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }TClass,\ \textcolor{keyword}{class\ }RetType,\ \textcolor{keyword}{class}...\ Args>}
\DoxyCodeLine{00707\ DelegateMemberAsyncWait<TClass,\ RetType(Args...)>\ \mbox{\hyperlink{namespace_delegate_lib_a75ff1e13f1cb691402002bfccaf9d1b2}{MakeDelegate}}(TClass*\ \textcolor{keywordtype}{object},\ RetType(TClass::*func)(Args...\ args)\ \textcolor{keyword}{const},\ DelegateThread\&\ thread,\ std::chrono::milliseconds\ timeout)\ \{}
\DoxyCodeLine{00708\ \ \ \ \ \textcolor{keywordflow}{return}\ DelegateMemberAsyncWait<TClass,\ RetType(Args...)>(object,\ func,\ thread,\ timeout);}
\DoxyCodeLine{00709\ \}}
\DoxyCodeLine{00710\ }
\DoxyCodeLine{00711\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }TClass,\ \textcolor{keyword}{class\ }RetVal,\ \textcolor{keyword}{class}...\ Args>}
\DoxyCodeLine{00712\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_sp_async_wait}{DelegateMemberSpAsyncWait}}<TClass,\ RetVal(Args...)>\ \mbox{\hyperlink{namespace_delegate_lib_a75ff1e13f1cb691402002bfccaf9d1b2}{MakeDelegate}}(std::shared\_ptr<TClass>\ \textcolor{keywordtype}{object},\ RetVal(TClass::*\ func)(Args...\ args),\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread,\ std::chrono::milliseconds\ timeout)\ \{}
\DoxyCodeLine{00713\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_member_sp_async_wait}{DelegateMemberSpAsyncWait}}<TClass,\ RetVal(Args...)>(object,\ func,\ thread,\ timeout);}
\DoxyCodeLine{00714\ \}}
\DoxyCodeLine{00715\ }
\DoxyCodeLine{00716\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }TClass,\ \textcolor{keyword}{class\ }RetVal,\ \textcolor{keyword}{class}...\ Args>}
\DoxyCodeLine{00717\ DelegateMemberSpAsyncWait<TClass,\ RetVal(Args...)>\ \mbox{\hyperlink{namespace_delegate_lib_a75ff1e13f1cb691402002bfccaf9d1b2}{MakeDelegate}}(std::shared\_ptr<TClass>\ \textcolor{keywordtype}{object},\ RetVal(TClass::*\ func)(Args...\ args)\ \textcolor{keyword}{const},\ DelegateThread\&\ thread,\ std::chrono::milliseconds\ timeout)\ \{}
\DoxyCodeLine{00718\ \ \ \ \ \textcolor{keywordflow}{return}\ DelegateMemberSpAsyncWait<TClass,\ RetVal(Args...)>(object,\ func,\ thread,\ timeout);}
\DoxyCodeLine{00719\ \}}
\DoxyCodeLine{00720\ }
\DoxyCodeLine{00721\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }RetType,\ \textcolor{keyword}{class}...\ Args>}
\DoxyCodeLine{00722\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_function_async_wait}{DelegateFunctionAsyncWait}}<RetType(Args...)>\ \mbox{\hyperlink{namespace_delegate_lib_a75ff1e13f1cb691402002bfccaf9d1b2}{MakeDelegate}}(std::function<RetType(Args...)>\ func,\ \mbox{\hyperlink{class_delegate_lib_1_1_delegate_thread}{DelegateThread}}\&\ thread,\ std::chrono::milliseconds\ timeout)\ \{}
\DoxyCodeLine{00723\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_delegate_lib_1_1_delegate_function_async_wait}{DelegateFunctionAsyncWait}}<RetType(Args...)>(func,\ thread,\ timeout);}
\DoxyCodeLine{00724\ \}}
\DoxyCodeLine{00725\ }
\DoxyCodeLine{00726\ \}\ }
\DoxyCodeLine{00727\ }
\DoxyCodeLine{00728\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
